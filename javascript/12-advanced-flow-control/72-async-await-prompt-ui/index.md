






(https://wesbos.com/javascript/04-the-dom/built-in-and-custom-data-attributes)
    1.  [Data Attributes](https://wesbos.com/javascript/04-the-dom/built-in-and-custom-data-attributes/#data-attributes)
-   [Creating HTML<span class="videoNumber">Part 25</span>](https://wesbos.com/javascript/04-the-dom/creating-html)
    1.  [append method](https://wesbos.com/javascript/04-the-dom/creating-html/#append-method)
    2.  [insertAdjacentElement method](https://wesbos.com/javascript/04-the-dom/creating-html/#insertadjacentelement-method)
    3.  [Generating An Unordered List](https://wesbos.com/javascript/04-the-dom/creating-html/#generating-an-unordered-list)
-   [HTML from Strings and XSS<span class="videoNumber">Part 26</span>](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss)
    1.  [document.createRange() and document.createFragment()](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss/#documentcreaterange-and-documentcreatefragment)
    2.  [Security and Santization](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss/#security-and-santization)
    3.  [XSS (Cross Site Scripting)](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss/#xss-cross-site-scripting)
-   [Traversing and Removing Nodes<span class="videoNumber">Part 27</span>](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes)
    1.  [The difference between an Node and an Element](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes/#the-difference-between-an-node-and-an-element)
    2.  [Properties to work with Nodes and Elements](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes/#properties-to-work-with-nodes-and-elements)
    3.  [Removing Elements](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes/#removing-elements)
-   [Cardio<span class="videoNumber">Part 28</span>](https://wesbos.com/javascript/04-the-dom/cardio)
    1.  [closest method](https://wesbos.com/javascript/04-the-dom/cardio/#closest-method)




##### <span class="grit">Module 12 - Advanced Flow Control</span>

-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/66-the-event-loop-and-callback-hell" class="currentModule">The Event Loop and Callback Hell<span class="videoNumber">Part 66</span></a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises" class="currentModule">Promises<span class="videoNumber">Part 67</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises/#then-method" class="currentModule">.then() method</a>
    2.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises/#promiseall" class="currentModule">Promise.all()</a>
    3.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises/#promiserace" class="currentModule">Promise.race()</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/68-promises-error-handling" class="currentModule">Promises - Error Handling<span class="videoNumber">Part 68</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/68-promises-error-handling/#promiseallsettled" class="currentModule">Promise.allSettled()</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/69-refactoring-callback-hell-to-promise-land" class="currentModule">Refactoring Callback Hell to Promise Land<span class="videoNumber">Part 69</span></a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/70-async-await" class="currentModule">Async/Await<span class="videoNumber">Part 70</span></a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/71-async-await-error-handling" class="currentModule">Async/Await Error Handling<span class="videoNumber">Part 71</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/71-async-await-error-handling/#handling-errors-with-higher-order-functions" class="currentModule">Handling Errors with Higher Order Functions</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui" class="currentModule currentPage currentSection">Async/Await Prompt UI<span class="videoNumber">Part 72</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/#running-an-event-listener-only-once" class="currentModule currentPage">Running an Event Listener Only Once</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/73-async-typer-ui-two-ways" class="currentModule">Async Typer UI - Two Ways<span class="videoNumber">Part 73</span></a>

##### <span class="grit">Module 13 - Ajax and Fetching Data</span>

-   [AJAX and APIs<span class="videoNumber">Part 74</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis)
    1.  [What is an API?](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#what-is-an-api)
    2.  [JSON](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#json)
    3.  [AJAX](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#ajax)
    4.  [Public API list](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#public-api-list)
-   [CORS and Recipes<span class="videoNumber">Part 75</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes)
    1.  [Query Parameters](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#query-parameters)
    2.  [CORS](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#cors)
        -   [What is CORS?](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#what-is-cors)
        -   [CORS policy](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#cors-policy)
    3.  [Babel](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#babel)
    4.  [Browserlist](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#browserlist)
    5.  [Proxy](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#proxy)
-   [Dad Jokes<span class="videoNumber">Part 76</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes)
    1.  [Headers](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes/#headers)
    2.  [Getting a Random Index](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes/#getting-a-random-index)
    3.  [Loading State & CSS Loader](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes/#loading-state--css-loader)
-   [Currency Converter<span class="videoNumber">Part 77</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter)
    1.  [Caching the Rates](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#caching-the-rates)
    2.  [Converting](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#converting)
    3.  [Hooking Up The UI](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#hooking-up-the-ui)
        -   [Input Event on a Form](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#input-event-on-a-form)
        -   [Wiring up Handlers](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#wiring-up-handlers)
        -   [Formatting Currency using Number Format API](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#formatting-currency-using-number-format-api)

##### <span class="grit">Module 14 - ES Modules and Structuring Larger Apps</span>
##### <span class="grit">Module 15 - Final Round of Exercises</span>


<span class="grit">Async/Await Prompt UI</span>
===============================================


JavaScript, Async/AwaitEdit Post

In this lesson we will be working more with promises and async await to build a sort of prompt interface.

A pretty common thing to do in JavaScript is when someone clicks a button or something happens on the page, you want to pop up a little box, ask them for something, and then go ahead and get that data back and display it on the page somehow.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:936px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:82.66666666666667%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAADCUlEQVQ4y22Qy08TURTG549QEqoBnGkJEcPGlS5cGK0UaJm2c2cAURMTQ4II9DGde/sw5SHFaCQUik8oLSAmmujGxJ0rF4IRwQeCQMojBSRBFPqAtnPNOBRrJPnl5OTe853vyyFEUYzHY9FodDm8HAqFlpaWVldWI5FoJBKN/sfW5tavzc2F2RkxsfP85StCB3u00KeFvhJL57nGDo25s5T3am0+ra1bK+xDGd+lMXeU2++dOG8i9HXNElebDfWtEtda9HUt+msSdLrSGb2+XmqMJs9J5grRec7s1fLeMqu3jO9ikLfE6i22+KqcwaA/0NcX8O+Dv6/3ydBAAw+J7hJrjx72GKCvHPYw6L4B3afRw0vu4aHAcLB/eEAmMBTsHwz4ZYL9fU+HB002gQBWj4TFw/LtgG8vrW/W1Lo1dU3FtW4ZTa27+GpTeWMra/YAcxswexhTWwV/61RFDaGg+WyaV+ht2TSfo+NrGryC2291PeJdj6wSvSbHA5vjofpCywGd5RBtU9C8grYqDCj7dDWhZJGSRSoWHWHhcc4x/nr00/vRybGxr+Pj0x8nJkZHQ1PTyY31O7cfZ2lNBRUOFYtUAKoqnHnqSwQJIAmgkoW5ABax9rcv3oS/LSxOhhYnQ+HphfnPs3OTc/H5tdYm/0GdKZ+zS/OMQHGOHPVFggKQAlAJUB6ARQz68HIEp3AqkhCjSTGWwrFUMp7E3zdvSGJzPmeX5hlIcU5SXU1QAP0VG9H4m4mf6xvRH1uJyHYisr2zFd+J7OD4dtvNwayyxrRYoDgXdaYqw5mFRQbh3auRWCKeSqUwxiLGoiiKGOPYdvP13qw/sfecqbNVu84UgCrOflhnuey6i1NJWYIxlreMfZkrZATyj8eeWHk27UwB6eaHynmNtWMqtDizuDKzJDG9EA6vrT97PZJjtO0qAZJjKzOdSTk/i45VuwqrnEfTFJ53FlQ6yN0BRAFEMgLJOZXqv87pDwDzjIJMrtGWK1XhiFHIGJMORnJOShZnbN3r4b+JUOZ72rnyN2AT/KZZkcfNAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/7525d17ee29ea705c4c209be94a1ad6e/6d2da/1076.png" title="what is your name diaglog box" alt="what is your name diaglog box" class="gatsby-resp-image-image" /> </span>

There is a prompt that is built into the browser, but the problem with that prompt if you can only have one input box.

If you wanted multiple input boxes or an image upload or something like that, you couldn't do that with the built in.

The built-in interface is also blocking, meaning that when it is popped up, you cannot do anything else on the page.

We are going to see how we can re-implement this with promises and async/await.

We will be working out of the `/exercises/72 - Async Prompts/` directory, and are starting with some very basic HTML.

    <!DOCTYPE html>
    <html lang="en">

    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Async Prompt</title>
      <link rel="stylesheet" href="../../base.css">
      <link rel="stylesheet" href="./style.css">
    </head>

    <body>

      <div class="wrapper">
        <button class="askMe" data-question="What is your name?">Enter Name</button>
        <button class="askMe" data-cancel data-question="What is your age?">Enter Age</button>
      </div>

      <script src="./scripts.js"></script>
    </body>

    </html>

We also have some CSS that Wes will explain to us because we will be using CSS variables for animation, which is pretty nifty.

    .popup {
      background: hsla(0, 0%, 30%, 0.5);
      position: fixed;
      height: 100vh;
      width: 100vw;
      transition: all 0.25s;
      top: 0;
      display: grid;
      justify-content: center;
      align-items: center;
      pointer-events: none;
      --opacity: 0;
      opacity: var(--opacity);
    }

    .popup fieldset {
      background: var(--grey);
      padding: 2rem;
      border: 3px solid var(--pink);
      border-radius: 5px;
      box-shadow: var(--box-shadow);
      transition: all 0.2s;
      --scale: 0.3;
      transform: scale(var(--scale));
    }

    .popup.open {
      --opacity: 1;
      pointer-events: all;
    }

    .popup.open fieldset {
      --scale: 1;
    }

The buttons on the HTML page are there so that when you click them, they will invoke the prompt.

One more thing we will look at is how to open one prompt after the other and get all three pieces of data back, which is going to be in a **synchronous map**.

That is pretty tricking to do, so Wes will show us how to do that, how to run something in series when you have promises in async/await.

Open up `scripts.js` in your code editor and open up `index.html` in the browser.

Let's get going on the JavaScript in our script file.

Let's start by creating a function, `ask` which will take in some options.

The options will be 2 things:

1.  What will the text for the prompt be?
2.  Are they allowed to cancel it with a cancel button?

Inside of the function we want to first return a new promise.

Inside of that promise we will have a function that will accept `resolve` as the first argument. (It also accepts `reject`, but we won't be rejecting it in this example.)

When somebody hits cancel, we will just resolve it with nothing instead of reject because that is how the one built into the browser works.

    function ask(options) {
      // First we need to create a popup with all the fields in it
      // check if they want a cancel button
      // listen for the submit event on the inputs
      // when someone does submit it, resolve the data that was in the input box!
      // insert that popup into the DOM
      // put a very small timeout before we add the open class
    }

Now there are a couple of things that need to happen.

First, we need to create a popup with all the fields in it.

Then we need to check if they want a cancel button.

Next we need to listen for a submit event on the input, and then when someone does finally submit it, we need to resole the data that was in the input box.

Let's start sequentially with the popup.

We will use a form tag for this so we can get the submit.

Use `document.createElement` because that will immediately return to us a DOM node, which allows us to add event listeners for things like submit on it.

If we just used backticks and a form tag, we wouldn't be able to add event listeners inside of the function. We would have to wait until that thing was put into the page before we could add event listeners to it.

    const popup = document.createElement('form');

Now we can add a class of `popup` to it, which just makes sure it has position of fixed, a specific background color, that the width and height are 100 percent of the viewport width and height.

We set the opacity to 0 because we want to fade it in which we will do using a class of open.

    popup.classList.add('popup');

Now we need to put some HTML inside of the popup.

We will use backticks in this case because there is nothing inside of it that needs an event listener added to it.

    popup.insertAdjacentHTML('afterbegin', `
      <fieldset>
        <label>${options.title}</label>
      </fieldset>
    `)

    console.log(popup);

Refresh the page to check whether the code still works.

Call `ask` directly from the console, and pass in an options object as an argument with 1 property in the option, the title.

    ask({ title: 'does this work' });

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:926px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:19.46666666666667%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzklEQVQY022PSW7DMBRDff8TFimQNvKo6VuSLc/xC+xuS4DghgNYdFrzUgrnHW3XUTUtOQ3I44tsNUG9SG1LVC8Ga7DesW8bx3Hc3Pf91m3bWNeVIueMWKHvAilEvC6ZhoirDLbtSU6YQiQoTTLCsq6M44iI4L3nyltrWZaFC8WyLogTrLKMISLND2Jami7y+DaEmJnyxOBHkkuc50lM8S4xxtD3PVpr5nn+K7wWyrLk+fukrmusE1RZ0dQVda2IMd7Gk/PW9/vNf7iGrusfWcsxg4gdjncAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/226afec3e24a89f9f232187d4b6f706c/69476/1077.png" title="calling ask function from console" alt="calling ask function from console" class="gatsby-resp-image-image" /> </span>

As you can see, we have the form, with a fieldset and label containing the title so we know that it works so far.

Now let's check if they want a cancel button using the options object, and if they do, go ahead and create that button.

You must specify the type of the button or else the browser will just assume it is a submit button and submit the form.

We also need to listen for a click on the cancel but for now, just add a TODO and come back to that later to keep things more simple.

    if (options.cancel) {
      const skipButton = document.createElement('button');
      skipButton.type = 'button';
      skipButton.textContent = 'Cancel';
      // TODO: listen for a click on that cancel button
    }

We still need to listen for the submit event on the inputs, and resolve the data that was entered into the input box and we need to insert that popup into the DOM.

Let's do that last step first.

    document.body.appendChild(popup);

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:866px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:65.60000000000001%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmElEQVQoz42S2W7bMBBF9f8/VKAPRdrAQNCkTWxDcRLZtTZL4iJS5JCSKHEp5LRAHtrE80BcgjjE3LkTzfMMACABQOnBCCGH0VgXnP+4ol7q5qXWnSJpzE7Hqpayg3BZRX3f05LUjxWtEWvaYl3ymi8v/hJ46ElJ8vsMGHjvZjPZ2Tq3dO2sCyG45eb+DXvvldbogCQSvDrS/JkzmexpHKMGSSGBZASnyFq7/DJb7/0bOCyzoWWLf+G2IB1KJaN5DbuUb/dtUsoCKd6BQJxmlByJGadXTz6EKIQwjn1bYLLHqsU42QBjecb3CQGpP/AsjOejPVFxKrqX+zLZVCfEu3Gm0LfasN4Q2XOYGBs6mIRxTBumJ5iCND66K9QaTVtsfx7E9VW6uik/fz98ujt82zVfd81VXH3ZFrdPfLUqb2P2o1CrZ3Jz4Bts17WJhLLQO0p09tiUT6jYNSjvGiykcqC91P58OjksWii36LMQykWvYbCyRedVuTDhP56ddSTF+UPGKhb+zvFtHu/Bk5m7pgMq/7cJ78C/AfZo6L8oa9RGAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/470ad4e2e52f0a1272d1eef1921c81d8/c1328/1078.png" title="adding required html code with form tag" alt="adding required html code with form tag" class="gatsby-resp-image-image" /> </span>

Let's get that popup showing up so we have a visual.

If you go to our CSS, you will see that we have opacity of 0 on the `popup` class.

The reason Wes has created a **CSS custom property** (or variable as it is referred to in CSS) to store the opacity value which we can then reference using the variable.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1010px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:83.73333333333332%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAACPUlEQVQ4y32SSU/cQBCF5xopwlt77LY9BhEiIhjvbo/D4N4XMxAUUCBRpCj5S7nkmvzUyCAQhxmkp1Id+lO9V12zoFFhq2Avw7Wc9ypEOmhkhBiolZXTR9kF28uolbPH3nnSzDo5DyvhE+yOPRRriKhTM6/kCZILpOJWpp2KG7Hfm7gVCyTDWjzzM2eJvRz7LUv4mI4X6Tgm0hzizXB9vzZ3rfy8vrov6CW9+V7xTyt9czpc2/kTbC8xyAlAFHINqUqU8Vt5hOVS6aCVdk6dnDoFsx+qUzD3pe1H2Ecs0ePB1YXfqyOiGs3Sjlkv3m3VBHs5AS2LlUnMGCJZanU6YLfgVkatbFrSTthZYlAQr6ERM5EwMTf7Qqdn8mhQ0Uq8G0S64s8ht0ye4JpGXCdEL7B2O+HWIlrxsBVJzyPE7VdtY9DSSOgE62StvYLFK+5X3MrYXsb2lq/YzrBfUIAYpGoxPjj/KJajOSDGLljQcthxUPHXMoOGRtxEXEdMB4OCXMdCB0gcU/mBq7hXW2PP5hUPa+41NBZ6oQ0k0/zwXB+u5YmQ76m2C75r4TO/ZGDKzKG4jOQGsssAT3fmn6l4JTJtYKfsXXBQy7AiVn315uKP+/Xv29t/6bffx2IDau4VzC+ZnZGd8Lzi85K4jYSbH/H1z8D8Soa7EtOgHSP5JVF3Mb2Fzbj1t2agZPOShAj7iIAGgxZ7+XlYUa+UoBtBZ/xunFdqZ2a/pKAids4mZcwumJVP1c7p5Dmju2z/B1v+vi/ZI6twAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/5fe01984b905746b5e55d0e15bf3952e/5b587/1079.png" title="define the popup class styles" alt="define the popup class styles" class="gatsby-resp-image-image" /> </span>

Now when we go to the popup with class of `open`, it will know to update the value of the opacity variable everywhere that it is used.

So right after we append our child, we need to take the popup's class list and add a class of `open`.

    document.body.appendChild(popup);
    popup.classList.add('open');

When we click it, as you see, it is not fading itself in, which is a bit of a problem. That is back to the whole event loop that we talked about a few videos ago.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:916px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:70.13333333333333%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACoklEQVQoz33L609ScRgH8PNnJOqWsLmJ71rNF239CYKJim4ubS61iy4OyMXRVFQuHjLDa5oYarZeJBKu1rteuKWYhgrFAAfHw7n58xxuQ+mkNCGbleu7z559t+d5IGF9p7BRK2w4c0tb2qAtbdQK6ztLatQl0v+BhroGkbs684M+8z2dub3f/FCP3O813el+rBkYnpy0jE1Yxics489GLgKNNDwauNKMlLUiZa3ma62DN9qQqy1Pr7dbm/SvpmwLI9MLY9ZZy6R1emrG+vwvUH/3YA9s6FEYexRGncrUpxroatN9fP1hZ8ezufp507Wx7d52vVvpNQ4Zh8YMT0bPg/g1Kn6dml+bJVUL6jSFN+WOufdBt3tr1bWzth7Y2vrkXLlcLiuqUhVJlEWVHb9IlJCgWiWoUgqqVL8VVSrKb/e1KEeb5MNNckuzcqS62ciXdJxe/gkqlmqKpeoszdnUFEo68sQyXgXMq4DzxHBBpaK4VpNbnQfxRHCeCD6d5TJetvBEcL5IViCW5+SL4ALx6Tbn0lnhiWDIMGM3zNj7p9+Y55f11kXjiyWjzWGecyKzS4jNjtjsgy+dJpsDmXOa55dzTDbHwOxbvXURAhRJERESx465NKCJXb9v1++LR9k9HKx/8a5teCgQS8TY70cpLn34I33EpVNHqWQqEWMBDfkDAXRvz+PxkhQdCO4eMCwbiwGWjdBRAiRQkgnj+x7v12Aw6Ef33d/C3gDm8/mwSMTlWoeIbEKhEMMwKIqyLBtnmNgBSEbZ+AGIHYAY2EfDYZqmaCaJkQyxH6Vpmo1GURSFOI7DMAzHcQAASRCAYRI4zgYCCYpM4pEURR6SZCqZ5Dgu809On+PxeCgbAABFUSiGRQgCw/Hjk5NMJnOSvTu5KD8B7kgIMKQyLYEAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/88c7a2afd7a4108d53bb34cb06e96614/59822/1080.png" title="making the does this work popup appear on the screen" alt="making the does this work popup appear on the screen" class="gatsby-resp-image-image" /> </span>

The reason it is not animating itself in is because it queues up the "add a class of `popup`" and "add a class of `open`" sort of at the same time.

There is no time for it to transition from regular popup `opacity:0` to popup open `opacity: 1`. There is no A to B to transition itself from one to another.

The solution there is to put a very small timeout before we add the `open` class.

That will stick the code that is beyond it at the end of the event loop and that is enough to give A and B a little time to transition itself.

Let's add a timeout of 10 milliseconds and then add the class of `open`.

    document.body.appendChild(popup);

    // put a very small timeout before we add the open clicks
    setTimeout(function() {
      popup.classList.add('open');
    }, 10);

Sometimes you can even get away with doing a 0 second timeout.

Why does that work?

As we learned earlier how the event loop works is that when you have a timeout, it runs it, then sticks the callback in the Web APIs which puts it in the queue, and then the event loop will pull it back.

Sometimes you will see this where somebody puts something at a timeout of 0. All that is doing is it puts that at the end of the event loop so that the other code finishes running by the time we add our class list of open.

Wes has tested that in a few browsers but it doesn't work too great, so let's change it to 50 milliseconds instead of 0.

    setTimeout(function() {
      popup.classList.add('open');
    }, 50);

Now one thing we can do is instead of using `setTimeout`, we could use `async/await`.

Let's code that `wait` function again.

    function wait(ms = 0) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

Go back to where we had added the timeout and replace it instead with the code below.

    document.body.appendChild(popup);

    // put a very small timeout before we add the open clicks
    await wait(50);
    popup.classList.add('open');

You might notice your code editor yelling at you that you have can only call `await` from an async function modify the function to make it async as shown below.

    function ask(options) {
      return new Promise(async function(resolve) {

The reason we did not mark the `ask` function itself as async is because you have to mark the parent function which is the promise callback.

Now that should work exactly the same way as it did before when you call `ask({title: ' does this work'})` from the console.

Try opening Firefox and testing it there to see if it works.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1500px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:50.13333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAACS0lEQVQoz2PYeu7ahlOXVh4+vWzf8SU7Di/afnjl3pNVE+ZbhmTZReXZRuQ5xxW7Jpe5Jpe5JJU6xhU5xhXZRuU5xBZaBKczVKW1VCU2ViU2lWV3VPfOrO2d0Tx5VkfH5JmpXdOTO6cnts+pn7pk1aolS1csWbZiyfKVi5evWLxsxcrVazsnTGUoyugoSG4tSW47snzXo8tXdq7fVdY9PbG6xzWjzTOz3SOz3TO3w62g0zm3wyWvw6Owy7Owy6Og07u41z61jkEkskYkskY8qtYxryegeKJFSju/f5lUcLlafJMqGCnHNlqktPsU9Ltm92rENinHNKrENKjGNSsElzAUTl5ePGVl/sRlGX3LkrsX50xaUTFzbVDVZI3YRt3EZr3EFpXo+tqepRdPnN+68YB1WodmfJNuQrNuUptaWCnDqxfP3799/f7N608fPj5/9vL1y5ffv32funqXYmStblKLdkKzVkKzYVKrRXqHaWq7TkKzNgg16UA0v3j58uHjx29evnz37On3d+8+ffz4////2Rv3K4RX6yY2a8c3acc3acU3asQ1aMQ1QLja8Q06iS1qocUM3759//zly/dv3358/vz727efP37+//9/wfajinFteuk9OqndOmk9OmkgUju1G450M/rVomoY/qOCP3///v//f+7yddImrlrOYWqOIaq2vmp2fmq2fpqOQZqOgVpOQep2/io2PkpWXuia//4BaZ4/d76KkqqOjpGehqGqgrKSrIKKgpKupraupraelo66sqqaopKyiiYAYYEwj0ak+cAAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/bf999eb879e45aaff0d165b2c649c229/aa440/1081.png" title="opening different browser to see if it work there" alt="opening different browser to see if it work there" class="gatsby-resp-image-image" /> </span>

GO back to our fieldset and put the rest of the inputs there.

First we need an input with type of text, which we will name "input" and a button with type of submit.

    popup.insertAdjacentHTML(
      "afterbegin", `
        <fieldset>
          <label>${options.title}</label>
          <input type="text" name="input" />
          <button type="submit">Submit</button>
        </fieldset>
      `
    );

If you refresh the page, you should see an input with the button.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:571px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:51.2%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACg0lEQVQoz03Q3UuTARTH8eePCNKbyopKrJx0lWLQVQSucKmUpemWaYiv29TpdFM3N9/KDHVuy6w0CMKboKgggoTSMsc2dbq5R3O+5FvgS0JdfMNNs4sP58fhnHNxhIWlVeYXVwjML+LxTeH2+HB5fAwOu/jicAfrwDcnQ85RvjpGgr3d/siEH9/0LK4RD5N+kf6vDgSJXIdEoSdml1xPdGYVUdfLObkjlCtCblRwKk1L9M0qJP+JyawmKqUQoVhjpkhVR5E6pLDURJmqnkaTnUaznYZgfYjZaKWu1oLZ2El11QOUukZUhmZUtc0oa5oprWtBrqxEaJOVcj82l9bzebSey6M5Noc3WjuibwL30BCjDgdjTiczop+luVlWVxbxDjroabfS29NN7+NH9HR38bz3CY1NTQgthUbu3tJxL1tPS3Y1DVmV9Bm78DnHmfKJTHlFRJeXJf88a3OrrM+s4nj3mfZ7bVhsNiwWKx2WTuz2h+iNJoS42zriskPic7Z/WI7BYGfjk8ivgQBbgwF+/1hn6+cmm8tr/FneoP9lP/HXNZxVVBIr13I2U0ucQseZqwUIh66oOCQLOZJUwr6LeWjruxFTnzJ01MTwcTPevs9Mz87gH/OxEAjw4d0njkmLOZisJiJJzfaNiORSDibcQYi8VsauqFQNB2RKyqusiM/6cd19hbvlNRMfHXjd44wPj/LdM8nbF+85LVNzIlXzbzcytZxjibkIYQkFhEtDwqQF7Jfmc1haSMy1MiQ3NCFJJUQnqoIkMjVRl5WEJ+QH54O286Uiwi8oEBRGGxk1FtL1HWxnhcFGhsFKWrVlT00nabV70g2dyA22HdagLFMXKSoTfwG7Dws9HaKOQAAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/975e0f889202d9525194db1d51fc3b31/17d73/1082.png" title="does this work popup with an input and submit button" alt="does this work popup with an input and submit button" class="gatsby-resp-image-image" /> </span>

If you try to enter a value into the input and hit submit, you will see that the page refreshed and that we get the value entered in the query string of the url.

![entering a value into input and hitting submit will refresh the page and we will get the values as the query string of the url](https://wesbos.com/4713694a4a8bef961894d2ad010535cb/submit.gif)

We need to use `preventDefault` to stop the form from submitting.

Before we do that, add the cancel button onto the popup if the option is passed, which we forgot to do earlier.

     // check if they want a cancel button
    if (options.cancel) {
      const skipButton = document.createElement("button");
      skipButton.type = "button";
      skipButton.textContent = "Cancel";
      popup.firstChild.appendChild(skipButton);
      // TODO: listen for a click on that cancel button
    }

Run `ask({ title: "does it work" })` in the console to ensure the popup still shows up.

Also try running `ask({ title: "does it work?", cancel: true })`.

We are getting an error.

> Uncaught (in promise) DOMException: Failed to execute 'appendChild' on 'Node': This node type does not support this method.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:573px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:126.66666666666666%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEo0lEQVQ4y3WS22/TZhiH3ft2N6O0XKDubtr1xPbXjLINBhOttnEBmwrldLVdgbR/YNMGTdJkoQOKKibSNofaSez4lDjOyXZtfz40PsRx0jixPTmlGtLEp0c/Pe8nvdL7Si/0ptI5qKv7pJip8C8LzCu4kd4l07tEep9M7eFbhepWnk7nqHQ24gXM/IPzr7F2OoPBTR2aX4kv3Hq+cHNr8ebfi9M8d+v5uR9fLN7YOruSWlhNnZ2ysJpaWEmdXUmekpq/vgmVcywar5Q38XKigm5RaIooJyqlp2Ui12poPVY2WWC9Bxsyf91tf/JL59NHnQuPuM8f8xcecZ89bn/8c/fuqzAMAz8I3/8gNMuiGxgar6BxDHtGoikcTWDleIXKtZu60wBWU7Gbit2Y5rs0FAs6fyO1dOfV0tr20u3tpbWXkaxtf3T75dKt5+e/e3b++yk/nErk6VNPQ7NfP5m9vDl7OTF7OTF3JTE3lcUrf859szl3LTl3dcq15P/9g6tJ6MNvY2dW02eu/zW/8n5W38l3gKAv/oAuxWcuxaGLGzPLsZm3HoOWY9H/l/FIlmPQxQ3oUgz6KvG2XI7NLMegn37fW48V154UHqaw9Rh8ewO+swE/2ETvb5bWNw7Wnx48TKJ348UHSezhZvneb3v3k9i9ROleorQeQyBN5CxN1kQ+HA8tTT5ss4et+tA2VEWjaYYiq7ZhDu1u6LlB3xow9GTkegN75BhOV4UIihYlmarWFFVvtTumZduOe2TaomYDw+WAKQCDICleENnDI6oDqk2x2e60OL6MVSCBF1RV43nBME1BECzLcgzD6XZdy3S6uqVrPV2XJQkAwEnaoazLoq7IQNU0WZah/mAAVFWUJE0/kgA4Mgxblo12u6corqK6AAxV1RuPgaKomjoaHh/rrtPtHXuj6MJ6mjZwehLPSxxn6bomiYokAVHUAfDH4+gIgyD0/Sija/XDMCqDkRd6I8iEYZckBtmsm826COJVqx5NDxCkn88fM8xEljxB8BXQ67R5GOYRRCEIrlQyOS60TGggSwMEMXd2rJ0dJ5/vI4hTLNr7+3Ym46Kok8v3Mm/ccqlfKpmvXxvb29benl3Ij1rNwOhCriyNCGIIw+7+/kTXAl2biIe+KPrioS8IY57zBcEXDyeS6AMwbjYDBUwA8Dgu6B5FzRNdc2o1h6k1KliHwFkUpeCDOlom4QO6iNBFBC/kaQRuE3ibomqlYqOCGfzJ2ECWmBqazVZLRZFh5HqdI0mepjiS7BCEVGfaBC7QlECRYq0K6oxUq8pMzZWl0DSinY811WQYo1yeVOkxUxthWMCyPs+PSWJMEGMCn9RqgdENe3ZoWycEpjHdWRIDyxp2Og6OG4VClyKruVy9UKALeTyzS+7vVTJv8N1dIpfDs1mqUOBIol4qtSqYf7KzwrI0gpAwTBfyarMBGg2ZrfM0JdcZjiQAy4pMladImamJ1araZAFb15uNt80jTbXq9S6Bdw8Kxxg2xFCPqU1arUASoyFNM7TMSKypmMYJ0di61nWdfuhPQs8LRyPfdSf9/mQw8IdD/3gYjL1gPI7S8079P/4FFIGFaG1k0v8AAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/a798a2c240667fa12264af893b6b8b7b/3c024/1083.png" title="Uncaught (in promise) DOMException: Failed to execute &#39;appendChild&#39; on &#39;Node&#39;" alt="Uncaught (in promise) DOMException: Failed to execute &#39;appendChild&#39; on &#39;Node&#39;" class="gatsby-resp-image-image" /> </span>

Why is that happening?

Let's debug by logging the value of `popup.firstChild` before we call `appendChild` on it.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:573px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:66.66666666666666%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAACaElEQVQozy2P2ZKiQBBF/f9v6nEbRbAVUAdQBESg2Itix1qgJuiZfDgRGZEn8t5F13VRHEdRVMDC93yEUAUA8rwqDCsAKhDWALRNGwSBG0Rp3pQAobRo2oYQspjGsYAQBEFT10PfM8Ym/Bn7Yfxg2nW07dgwMMbyPAdBEIchSiHwgrIqOeeLkXNYFJZtx0lCKO2Hoen77vPpMZ74PP+IMa7rGhWoaZuyqj4Yz/IHwhahPAyB46A4Tjwvct3IfaW+Pw3DRCmnlBMyUTIxOjHGx3EkhA3DhPGiV9Xm+N2v1t163R8ORNfI9dILQrfdYsNgvk9erwmA0jTd3c7e7aPT6SUekOtyVCw4gq0oVut19fXVnU/t6dQpSr3bN4LQq5dWkurttleUXpGbzab6+tVIYns8UsfhBVzwPBtUtT8IvSTRLB2jiAYB8T3q+9Tz8Nul3psFAQOAhQBbFotjEgLqvWd5gjlO4krTSsN4yGdLUfSjdBEE7SipgvBHFK+Hg7zbXQXBvd2el4smiZaqoLfLSzTL79v1e7MxTqfYNDPrCXQtNh+hroeGkVtWoOvJ4xHd77llQdtO5xsLJ/FPbJjjLK3u91pVmKYRQ/+cz8w0qWOTy4VcL4OiEF2fYM5LxMtiJip4AX/kAtI8a8xHqSq5IES3myYIt/1e3f6W1yt5tTovl+f1+rhcypuNutvZqqqJ4lOWp3+dfV27HoSbJOnCPrOszLGTpxk+7qltB4aRO05iPcPHPbOsxDThy8ltG7mv+fOY5yRLG9OsNb06fmNVHWSZ3O/0+ZyCgFfVHBIhXpYzUfl/RcUE4V+pkboFhI5FPwAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/9467f8739bc92895490a5e762dfb65ce/3c024/1084.png" title="debug the logging value of popup.firstChild" alt="debug the logging value of popup.firstChild" class="gatsby-resp-image-image" /> </span>

As you can see, it is returning text node.

If you scroll up to our code, you will see that where we created the fieldset using backticks, we had the fieldset start on a new line.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:576px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:62.93333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB2klEQVQ4y5WS2W7bMBBF9QkiGceWDBhI2gIOosW161jcKVFx0wR9CRr0/7/kFqQULzVSoA8XFMXhmTszTJb9G5b+Nxa7Ryw5x50QuFcCleW4UwqFkVg5jtoJzDYWpHJgtQWtHGhlo1jtDkryh++43f/Ezf4Jt73Hp32PG++xaByytUG2MXGdfzOYrAbQALRnwPc1IaXBlPeY22fk9hlz/4LM/ABbeZDSRUdRpRthlzp1mbCVA6kNSKWj0kKDFOYs6OjkxFn9gcMApE6AeQHaClDPka410nuNtBwTVCYq7GlpBxXukOQ0ccLqFvSrBdMSpOOYGoXCP8VBLbs3fDavWPAXfGl/YelekSuDVAuwToBJdXQbwJU7AqmSoF6ACYXMWuSdx0x3mLUdJo3DNe+Q9Q5XUoGoARjvbPXgthyGNQDD9MxQMmnCBYnUNiCNQGp4BKRcIHUNiJSgVoA6CaolaHC506BrMzoM72ljQEPGEBiChAIL/eQqOo79DaAHHfsdey0UqBmhYb/TIzCUq2UEsJC1G4JZKGFUKOmqajEJ1RQOrBjPxlLpuA99TMhh/O7Q3NPvMD1SWUzXHebbxzhtdjg7rux9KPn2/K39rcu36C7+nSrJt+0/gf+rP6McjTfyG+tVAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/b0578f02c62cfb92c81012afdf0ee899/533c1/1085.png" title="code where fieldset is defined using backticks" alt="code where fieldset is defined using backticks" class="gatsby-resp-image-image" /> </span>

If you just modify the code so that the fieldset starts on the same line as the backtick, it will work.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1480px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:29.599999999999998%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYUlEQVQY02NIiqtJjKnJb5xWMmFBWd+CrJr+nMZ+3+QiHg0LcWNnaUsvCcsAKSt/SSsfWUs3GQsPcUsvUVMvISNPYSN3hqLk+tLUxnvbT/49de//s48rVm4sb5sYk1vBrWYua+Gh4eSn4eiuYWuv6mAnZWovpm8nYmgvom8vrGcnrGfPIOxXJBFW1pY5bUHU1OXVS92zOjidc0Uc4kX0bEXMvCXdfGQ9vCUsfMXNfIXNfARNvYWNvYVNoYhh0rItU1dsm7xmx4T1Oyet2TFz7Z4FWw7nNvXzaViIGjoLWtuKO9lLObhL2LuJOdkL29kKGzsKGzhBEMOHN6++fHj36+OHL6/ffXn39uWr13+//1i/ZRuniqmYkZOwla2wtY2Qia2QKQgJm9oJG9sJ6ztAEMOHDx9fPHv58tnLz+8//vv778PHT////9uyez+niqm4sZOIgYOwnoOwniMYOUARTDMAkymGovSlbhsAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/7cb260a0dfada20b30dca7407026bd03/536c7/1087.png" title="modify the fieldset starts on same line as the backtick" alt="modify the fieldset starts on same line as the backtick" class="gatsby-resp-image-image" /> </span>

What happened is when we had the fieldset start on a new line, the new line was treated as a text node.

If you recall `firstChild` will grab all the nodes, not just elements. As Wes has mentioned, if you want to just grab elements, you should use `firstElementChild` instead.

We were trying to append a DOM node to just blank text, which isn't possible, you can only append it to actual elements.

Leave the fieldset on the separate line and then modify the code to be `popup.firstElementChild.appendChild(skipButton)`.

That fixes it!

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:576px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:77.33333333333333%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADh0lEQVQ4y12Q3U+bdRTHnz/Cy0XQxGS6xCvnHWEaJSgJo8AUrWaZLmTgoAVaKHEJkUFpAdlEhhqNvMgWr4gX6q03ZDjceGkpW1v69rR92j4tfacgXfmY34PDxJN8cnKSc77ne46kH7Cht9jRsmDQjr7HyqfGCa72TnK1Z1LLnxjHudJt54rBzuXrY3zYa0VvtqE3j6E3jfFRv43W7iGkbzuGuf1mN1819DL9Tg9T9UZ+bh/Hu+Fka+UB26sPca7+hWfdgexyE/H4ePLHA+5+9wNLS/PcXZxnaWGOe0uLfDN7B2nWMMrtRhPTlwaYbh3gVms/9wy38AR8uLxuPEEfO143YTVGej9PtlTg8ZqDhdnvmV+YY2Fujvm5H/lpYZ6vZ2aQdL2j6Pqs6PpGaTFZedd4k8+H7lBK5SD7N5XcIZSeUkmXOEoVEeFc3eK9zmEajSPoDCM0GUbQGUdp6LiBVKUz87yGiReazTxXb+CyZRq/eZmt81Nsvj6F88IMztoZNl6xE/59g7W1Tc5dNHOm2Ux1cz9VzWaqRL7YjXS2zYLG+xbOfTBIlc5Ee/80yuIKHssy3hu/sHvzN3aHfsVtWib252PWVx7x2iULL7VZeLltUJs9K3Jrj3DYp4kIqnUmzjT18arOTOv1cVp6JjWajYIJWnq/pKXDRsPHX/Bik0m7quoUM9WNXUh1XePUdY/zdpddo94wQZ1xktpOGzXto9Res/LGZzYu/FvXdFip6Rw77X9GnWGSt64NI+3u+giFZHZ9PvbSaTweLw6Hkx2Xi2Qyhcfr5+GjDbYcLlQ1haIoZDNZ0uk0mUyGZDJJPJEgHk+w6dhCCgYCyLKMTwimUoTDYRKJBKogmcYbSvLEH8flVZCVJKFggFgiSTiWJBBJEIkqxOMxlGiU9Y11JL/fj6LEcLvd2rZAIEChUKBQLJIvFMjn8xT390lnMqT29tjedhJNpPCFVXZ8UXaDMtFoBKFzf/U+UqlU0hwKV+LkkCyTyWbJ+H1kgkGy4TBZWSYnyxRiiiYeCAZRYjFK+RL5UIZsOsvR0RGqmkCqVCqoqqqJCjf/xTEcn1Apl3laLmtZ9Aunoj8SiZBMnMwKY2pSRSqXy9pzxe9isRjFYlGrxYl7e2lyudyJ/PHxKWLm4OBA4/DwUBMTkVDjSMKq+Jn4nxAUAqlUSnMtEOJCRDh7hqj/v0REPK7wD4ZbozqXKrgyAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/8f72746931f067446ab93450e78adaa0/533c1/1089.png" title="does this work diaglog box fixed" alt="does this work diaglog box fixed" class="gatsby-resp-image-image" /> </span>

Let's also fix the fieldset so it's not on it's own line because that was sloppy formatting.

    popup.insertAdjacentHTML(
      "afterbegin", `
        <fieldset>
          <label>${options.title}</label>
          <input type="text" name="input" />
          <button type="submit">Submit</button>
        </fieldset>
      `
    );

Now that we have both the buttons, let's hook up the event listeners, starting with the submit button and preventing default on the form.

Pass an anonymous function to the event listener. You could make a separate function but keeping it inside of the `ask` function as an anonymous function is fine.

    // listen for the submit event on the inputs
    popup.addEventListener("submit", function(e) {
      e.preventDefault();
      console.log("Submitted!");
    });

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:568px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:93.60000000000001%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsTAAALEwEAmpwYAAAECklEQVQ4y02O22/bdBTH/U/wghC0lVjHC0Ko7VKxdTAeEAyJQTqalj2w0tRZt3ZamzS9pGuapGEt6iXbkIpGWcdAvKAJ0MQD4gHtCa33JI0Tx0lsx3c79i+2E6eNnaKkQtr3fHT01dFX+h5ILxsyKLKCiGZyOEnFETSeSMYSyf3YwQGSOkDQg0QqdoDEE6k4ksozPMXyqWSSFwS1VIY6XfOdrlCnK2SDgzY41O6cax/wtzVorzN3sjucAdtA0Oas0/HVnM0ZfMcZgAY94cHxMOwJwxN3Bsfm3eMrU7e/nfTdm/Tdn/DdG5+KjE9FvFOR6+4F2Lfg8i3CvkXXzCLsW4CnF6BI1/DdCyN3L4ysvjv84JPJ5D/Pkeh+fHM7sb2b3Nljszkmk5XI/N+Pn2ysP/j5x42fHj084fGjDWi1b2r1i+nIFd/Klem1gUDs3919DEHxDEbkcnQeGDooqQoATzd+XVtbW19f//4FQRdvhk744GawbziMbSfJPVTLCsda1ZLKR3SxCio1q/rNnYfvOWcu3gh8eH2uQeCjoVmoye5psrub7Z6XL4129vt3lv9E3o7Euu7vdaxE21f331re//wHuSR7fWsvfTzScnm8kfc0dXte7x6DWnu8rT3e0w5vy2VP15ez8V+eYVO/oTO/pwNP07f/QL1P0MhfisD5fN+9cunWG70TrY56/pTD+2avG2qu17qbu92v2d2nPh2zw+G+8RWHe8kxtuRwL/V6lntGl/quLXY6Jl/9bLSlu55strub7O7T3begrmvz51yhc67Q+aHw+Rtf21zBtn5/21X/GWfwzECg7epse7+/zem3wcGzcOgsHDoJdw2F34f9EIplkVSa5ngUy+7sRXf3ojiRz1PM1vbu861tnMwTeYpmOV6UuDoiSTMUy6GZLEWTEEVRuVyuIBdohqYZhmEZURRxuhBP07FUHiMEhuXqI8oUJ9F8gWVZSZJwgpBEFmJZLoEgkiRlMlkFAK1UKup6AWiKVpaAJsgAy2SSqRQlaQksj+AciqGiJG1ubjE0DtEMQ5CkDJR6Z0EqSaKcwXSR11hGpSmQy5V1jeW4HE7IRVXlikVGkRXFrJrVig6BIpAFWWZkgeCLMjCKGiB5JS/IJG+oWtUoW6ap6TpTFy1ygsiJLMuaplUzDciolIGsiLQAeBkUFLkgA0kRaVErqJZlHTdkWWappBeLQNNVTVd1XavVrJplQDQnIukMks4QNEPSHIaTOMXgFK1VDo0jq3xoNqiWD81S5cSbpUq1fGgZhg4hGSqazKI4m0iTBKsoukmLmqQeCcDggSEAQyxWaFFFsHw0gSXSRBLLJ1CCB4YkK9Bx/YOaZdV3rWFUVWv44xeomab1P6ZlWvXj0eF/scc0IY5KEaQAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/a9488bd08f0463ee7ae363109066dad8/10e91/1090.png" title="typing wes text in the input" alt="typing wes text in the input" class="gatsby-resp-image-image" /> </span>

Next we want to take the value out of the input and resolve it. We have access to the `resolve` function bcause it passed as a parameter.

![](https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/1091.png)

Because of the scope of our promise callback, the `resolve` function is available to us in the higher function.

We will call resovle and pass in `e.target.input.value` but before we do that, let's just log the target to see what we have.

    popup.addEventListener("submit", function(e) {
      e.preventDefault();
      console.log(e.target);
    });

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:541px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:11.200000000000001%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeElEQVQI1x2N0QqDMBRD/f8flMncQ7XSrtNVN7D2XnukBg4hIZDmPE8kCzllVBU5dlSEXLusiOjtNdetZmUJM8YY+r7HOccwDEzTRFWTjkScI/7p+ceVj3kQ/choI23rsDbSdW9CWPltG1+74F+OtCcK5T6plFJuLrHJmUB9+qkjAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/4c278cf282e8c8de012e54e78ab720c4/9d576/1092.png" title="form with popup and open class in console" alt="form with popup and open class in console" class="gatsby-resp-image-image" /> </span>

As you can see, the target is the form.

Now let's see what input is.

    popup.addEventListener("submit", function(e) {
      e.preventDefault();
      console.log(e.target.input);
    });

As you can see, it returns the input with a name of input.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:515px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:12.533333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAnklEQVQI122MuwrCQBRE8/9flFqwEwIWggjmYTDuQ9xsduNNxBzJFmLhXM4wd4rJAJb1ltVJ8E0L7+WnSfmdfhHBWotSCmMM3nucc2RjPyKDMMsTCT3TGIhxYhiEEIXXJERnkRh4jhMxzgmjLW17oa5rmqZJwytZVZR0xw5/V1T7LaY9o/XA4XDlpjzhoSmLTeqVcuT5jtNJ07vAP30AMG/lYr+4GVoAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/2939f9fa16bef5dce003fd3903a4a0f6/fbdcb/1093.png" title="input with type text" alt="input with type text" class="gatsby-resp-image-image" /> </span>

Remember, anytime an input has a name property, it will be available via the property on the form.

To get the value from that input, we just tack on a `.value` and then resolve that data by passing it to our resolve function like so:

    popup.addEventListener("submit", function(e) {
      e.preventDefault();
      resolve(e.target.input.value);
    });

If you refresh the page and try it by calling `ask({title:'does it work', cancel:true})` in the console, entering a value in the input and pressing submit, you should see the promise in the console with the resolved value.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:571px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:99.2%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEOklEQVQ4y22S2U9cZRjGz5/gpYkUiG0shaLxzlst0Jq4lMJQlgFZBErVWGV2FkmZstQYjS1Cy1IG22r0RuOtsS2SLiwzMO0Mc2CYOXP2c76zft+ZAWaGOWZK7IXxyS9v3ovned6bF8sdZE3TzB1kEIS6quqqKvKcyLMCx/IsA0RB4DmBy8OzrKoou6kU0jWF55IGwrqv+i5c9XWPz3eMzLZ7p9tGZpqHp5ov57Fenmzx3mgenmoZzs/mocl27/THo3MdV2Y6vNOdo7NYRc/gqYuDFT2DlRe/qvp06FS7p6rRXdXkrmrynLZ6KhtcFQ3OPI3Oyq6Biu6Biq7+iq6ByguDb7e7sR86h74/67hW57pe6/rW4vjNMxkPRyJrG7g/iAeC0WCICOEkHt18sHJ7asa3MLcwn+e279bNG5PYpLX/WtWlifdsE+/bvzvz+e+uqSAefrK6sv4suBrwx0hC0lQZaVv+0N3JmTs/3rrjy/PTwvzszSms1TXe6hxrdY61O8cae70T3/gQ1GmaNv9V7iBnmmZkLdzdO9riGWtzj7XmGW+xe7GCc7ZDCmvtL7372aXh6YTnj40zN8Ln5kPnfaFaX/CdKeZ+aM3/tOxD+8vVvUeqbQXVtlfO2gqrv8SO17tK6l3H612lDe6CD77oH5lTvv4z1naX6Pw50fML+cmvsfp5eWkTD4TfqnMfq3eeeO4vqXedOO/AjlrsxyyOoxbHsTpHYY3t9EdDgyNz7uFpt3fGc2XWfXna453tvzJ3yXm9tNbxal3eduh/zWLDXm/uL7f2lVv7ypo8b7QMlFj7ii32wpreIou9uM5RbHEcqektqrUVWWylTZ6yJs9Jq6fc2nfS2v9msxtbXA4sraz/vRwIbEbvPVq993Bl8fFaMLLzeG3j/sMnS09Wg5Ho8nroKb6zEYluRHb8oa3l4ObKM/yvpUcYQ1E8y/AsY0DIMTRNkRxNyYq+GeXXQ/H1EMGLmgwEqOlA1nigqoqqybKuKvGdLQzHcZIkcRzneZ4gCIQQNAxFg5KGVJjkgMIBOeBfIxmB4iU8TuM7BEkmdmKxpcUHmK7rRCIhAFFSJJphEIIamUA8Z4gcEnidphHPa7pOUTRB86JsyKSsSoqRTEpAwDKZjCTJUIGqoIoM2NvdQ5yIWElngCFIaQjTydR+Oi0KAsPQMgAqJwscbySTqSTCMumMrumAAQIhyIwkS7ImQ5lVxISsSEbOzB3+WSqVUhQVSJIGNVlR9vb2DaRj6XRaBCJJkxRNqYoiSoAgiWhsO8EyAGbN/1Mul2/Mh03TzGQzSEIqraqMZsgGS7Lx7ThFUKndVDaVSiO0q2vZTOYwdijTNBHUsMMNEIAJMUyIoTYoLsyBbRFKCAIANsMGxyGWyWaz/7kMdQV73pPbhbuGbEARQglCkMcwknw8vg/hi8ALHRwcmKapa/I/l7pv2BsVRHsAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/9dca76e95e1f320aaa682b8e42c246c4/17d73/1094.png" title="call ask({title:&#39;does it work&#39;, cancel:true}) in console, typing the value and pressing submit, we see the promise in console with resolved value" alt="call ask({title:&#39;does it work&#39;, cancel:true}) in console, typing the value and pressing submit, we see the promise in console with resolved value" class="gatsby-resp-image-image" /> </span>

If we wanted to get the actual data from the input, we could just call `ask` with `await` in front of it from the console, as shown below ðŸ‘‡

    await ask({ title: 'does it work', cancel: true })

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:578px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:89.33333333333334%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADwUlEQVQ4y2WO708bdRzH75/wyQIGjVmy6VDAxh8QH/lsMYOIP8IYYyu0UJxSEFixLRQHbYHBJmEM2gJuAfWBZonG7JGLZsnIRmmh9Hd71157v9q73l3ptXdc72quqJn6zivvvPPJ+/P5fgGKZpl8IUPlYAQLxaAImDzwh7y+gNcX8Bz4fcGwLxDePwwe+INeXyAKJpMIEYeS8VgMhBGgqcfS1DvV1GtRQo+loWey/rKxvst4rspJru8yvt5tarwy0dit0NBtbuieeKPzOvC5wXZtePralwqfjVmHhm22Gafd5rLb1mft69YZ5/QNh3XGaTEvD5rmBqfmBy0KQ18v9F2/Aax2Gm819C61DCy9q1t8S/vTFXsyEg7s7gXce4fPdhPBEAmnKQJL7Pq+d7i2tza/u7+5fW/zh617a3fvALfH7PNq803N5E2tZVZj3hpfBlHYB4XxPJXOETn+iKscl2Qx+NR39/bKimNtZXXtzuraqsM5t3gLaNFOtOgmm/sn39NZmtRGvWk5+zgcvf+48AjkvTjnRfNPYYkT9ncO3r9sfKfH1KI2NatNzT3mt7tGgboPR054uX30hfNfXB37JnlpO/Daove0zfvi9H7jgvvUFPxgd89zeK5ttLZ95KX20TqFsbq2QeBMh+GEVy+O1300clW/EHD89sz0o3vqgWfhV8/SQ/f8L8HfPY9+/uPNTw2nOwxnq+WzF8fPfDwM1LQO1bTqa6t+qlX/yoUhVce4qsuoumRUdX6leJdR9YmhoW2k9oK+pvUfhmo/GAC0Vmef3aWZcehmN/rt631zGxqbS2NV0Cru1FhdvTaXdm5DN7tx0um3rw/Mfau2LAEEhlIZgsBRUSih6VQ8GkmCMZ4rIKl04NAfjURLhUKBZSSBF/mSKPBCkSsescVCHoxFgEg0CiYSwVAIw/FEIklSirAMFYapWDrnjxPxFBEMBRNpLJLA/HEkBsIwDIMQ9GRnB4BhGMdwCIQoioIgiGEYmqZZlj1imSOGZiiSJsloOIxhBIyRkQQGJVMEjqMo5t5zA8eCkPEhDEimkDROEDRNoxhKMTRPZhkQ5Ai8gKElHOcQROBLOI4hCMILQqVSyWQIQJZlLlfIZ9g8ky8LoiRJUlkSefGYF8tS5URypSKWy8VikS/xoihyHFcul7PZDFCWpDzLMDhFJrOZOMHSLJtlqhmjMUq5JEmyLDMMg6IogiDZbBZB0FKJJ8ksIIhiLpXCwXj1Cbnyb8l/6z/Dv75dPFYOi6L4XFP+/87zQ0mSqsuZPwGOdgT9yeQHqQAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/1ee4f6fad72c9756cfcf3ec0cb6e4f09/508ef/1095.png" title="use await in front of ask function to get the resolved value directly" alt="use await in front of ask function to get the resolved value directly" class="gatsby-resp-image-image" /> </span>

Now if you try pressing the submit button again, it doesn't really do anything, but that event listener is still there. You can tell that it is still there by adding a log of "Submitted" to the handler.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:578px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:89.33333333333334%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADwUlEQVQ4y2WO708bdRzH75/wyQIGjVmy6VDAxh8QH/lsMYOIP8IYYyu0UJxSEFixLRQHbYHBJmEM2gJuAfWBZonG7JGLZsnIRmmh9Hd71157v9q73l3ptXdc72quqJn6zivvvPPJ+/P5fgGKZpl8IUPlYAQLxaAImDzwh7y+gNcX8Bz4fcGwLxDePwwe+INeXyAKJpMIEYeS8VgMhBGgqcfS1DvV1GtRQo+loWey/rKxvst4rspJru8yvt5tarwy0dit0NBtbuieeKPzOvC5wXZtePralwqfjVmHhm22Gafd5rLb1mft69YZ5/QNh3XGaTEvD5rmBqfmBy0KQ18v9F2/Aax2Gm819C61DCy9q1t8S/vTFXsyEg7s7gXce4fPdhPBEAmnKQJL7Pq+d7i2tza/u7+5fW/zh617a3fvALfH7PNq803N5E2tZVZj3hpfBlHYB4XxPJXOETn+iKscl2Qx+NR39/bKimNtZXXtzuraqsM5t3gLaNFOtOgmm/sn39NZmtRGvWk5+zgcvf+48AjkvTjnRfNPYYkT9ncO3r9sfKfH1KI2NatNzT3mt7tGgboPR054uX30hfNfXB37JnlpO/Daove0zfvi9H7jgvvUFPxgd89zeK5ttLZ95KX20TqFsbq2QeBMh+GEVy+O1300clW/EHD89sz0o3vqgWfhV8/SQ/f8L8HfPY9+/uPNTw2nOwxnq+WzF8fPfDwM1LQO1bTqa6t+qlX/yoUhVce4qsuoumRUdX6leJdR9YmhoW2k9oK+pvUfhmo/GAC0Vmef3aWZcehmN/rt631zGxqbS2NV0Cru1FhdvTaXdm5DN7tx0um3rw/Mfau2LAEEhlIZgsBRUSih6VQ8GkmCMZ4rIKl04NAfjURLhUKBZSSBF/mSKPBCkSsescVCHoxFgEg0CiYSwVAIw/FEIklSirAMFYapWDrnjxPxFBEMBRNpLJLA/HEkBsIwDIMQ9GRnB4BhGMdwCIQoioIgiGEYmqZZlj1imSOGZiiSJsloOIxhBIyRkQQGJVMEjqMo5t5zA8eCkPEhDEimkDROEDRNoxhKMTRPZhkQ5Ai8gKElHOcQROBLOI4hCMILQqVSyWQIQJZlLlfIZ9g8ky8LoiRJUlkSefGYF8tS5URypSKWy8VikS/xoihyHFcul7PZDFCWpDzLMDhFJrOZOMHSLJtlqhmjMUq5JEmyLDMMg6IogiDZbBZB0FKJJ8ksIIhiLpXCwXj1Cbnyb8l/6z/Dv75dPFYOi6L4XFP+/87zQ0mSqsuZPwGOdgT9yeQHqQAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/1ee4f6fad72c9756cfcf3ec0cb6e4f09/508ef/1096.png" title="pressing the submit button again wont do anything as no event listener is there" alt="pressing the submit button again wont do anything as no event listener is there" class="gatsby-resp-image-image" /> </span>

One neat thing about `addEventListener` is you could remove the event listener for submitted as soon as it is resolved.

### <span class="grit"><a href="#running-an-event-listener-only-once" class="hash-anchor before"></a>Running an Event Listener Only Once</span>

There is a shortcut we can use where the third argument of `addEventListener` is an `options` object, and we can pass it `{once:true}`. That will tell the browser to only listen for the submit event once, and then remove the event listener.

That is very handy for things that you only want to happen once.

We want to remove the popup from the DOM entirely.

To do that, we will create a function `destroyPopup()` because we need to run it on submit and on cancel.

For now, in the code let's just call the function which we still need to create and we will pass it the popup.

    popup.addEventListener(
      "submit",
      function(e) {
        e.preventDefault();
        console.log("Submitted!");
        resolve(e.target.input.value);
        // remove it from the DOM entirely
        destroyPopup(popup);
      },
      { once: true }
    );

Let's create that function above our `ask` function declaration.

Because `popup` is scoped to a different function, in order to access it within `destroyPopup`, we need to pass it as an argument.

Within the function, let's remove the class of `open` from the popup and then wait one second because we want to wait for the thing to fade out before we remove it from the DOM.

In order to be able to use `await` within `destroyPopup` we will need to mark it as async.

    async function destroyPopup() {
      popup.classList.remove('open');
      await wait(1000);
    }

Then we want to remove the popup entirely. Add the code below to the `destroyPopup` function.

    popup.remove();

Before we had the `.remove()` method, we used to grab the element one level up and call `removeChild` on it and pass the popup, as shown below ðŸ‘‡

    popup.parentElement.removeChild(popup);

Thankfully there is now just a `.remove()` method that we can use.

If you refresh the page and then click the button and submit a value into the input, you will see the popup fades out.

Let's check one thing.

If we try to log the `popup` even after we have removed it, is it still there?

    popup.remove();
    console.log(popup);

As you can see, we still have access to the popup even though it has been removed from the DOM.

That is a potential **memory leak**, because every time you pop something up, you add all these things to it, such as event listeners, and simply removing the element from the DOM does **not** remove it from JavaScript's memory entirely (because it is possible you might want to add it back).

If you do want to get rid of it entirely, just destroy any evidence of it using `popup = null;`.

You may notice in the video that Wes' ESLint is yelling at him because he has a rule to not overwrite parameters. However, to get around that you could do something as shown below ðŸ‘‡

    async function destroyPopup(popup) {
      let myPopup = popup;
      popup.classList.remove('open');
      await wait(1000);
      // remove the popup entirely
      popup.remove();
      myPopup = null;
    }

The reason that works is that it is all references.

If we wanted to disable that rule in eslint we could wrap it in the following comment ðŸ‘‡

    /* eslint-disable no-param-reassign */
    /* eslint-enable no-param-reassign */

The next thing that we need to do is handle the cancel button. Let's hookup the buttons because at this point, Wes is tired of running the code from the console.

Go to the very bottom of the script and grab all the elements with an attribute of `data-question`.

    // select all buttons that have a question
    const buttons = document.querySelectorAll('[data-question]');
    console.log(button);

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:542px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:30.133333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBElEQVQY042R246CQBBE/f+P282aNeqCigxXYRDEGZiLnA3GGPfBZCupdCdVOQ/dC+89wzBgncV5hzEG7xzOWOxo8c7jncUOitvthjeepm6IjzHb9YosEQS7CCEStFYslFKEYcjPJmAf7BFCUJQn6qRGioYmrZFJSB4u6c8dp12JFBKZJmTBF2UcEBUKYyeUurIAcMaRbQvSVUpTtly6EWcG7KjnmGma/sx3ul4fQFlKKlFRHyvyTY6MM4rgg3K3fJZfoXe/7o/sCWzPHRfZUR0q6qjmnJdE60/i4ButNdZa/qM7cKbPd1StQrca3WnGYUQkKYcoIsuye3HW/JR3njl93/MLv/DNlLBNfo8AAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/fc22589206ff49d3d988c51d5025a97c/c0388/1097.png" title="selecting the buttons using document.querySelectorAll" alt="selecting the buttons using document.querySelectorAll" class="gatsby-resp-image-image" /> </span>

As you can see we get a node list of buttons.

Now for each button, we will listen on the click event and pass it a reference to a function `askQuestion`, which we will make soon..

    buttons.forEach(button => button.addEventListener('click', askQuestion));

Inside of `askQuestion`, just log the event.

    function askQuestion(e) {
      console.log(e);
    }

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:571px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:78.4%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC5klEQVQoz32O20/TUBzHm8CzQDJA/xgghMQ/QROjRjHBjYE8+aCJD6t4je8+CoSLoGxjwynOYGAq4e7W3Ypja08vO+3aruWsYxfYMS0oGhO/+eSXT775/U4OgfExbhxhjE10oMlQ1wp5HkABiBzLszkocHJeyPOsXVpeRsahiSCbNYoKcfHZ8sXnFn1PP/WOLvU+Wur2hGzedXnedZOhHtLybjLU5Qn1PPzQ9yTc9zhsbZJBwjW1ZTGx6RrbGJzZcZ+y657eGRzbHBz/C9fYhmts3flq3TW+2f9ymVBefOavTwp3/Ty5CO8F8wNz4u03/JVJY+47xrhxdIz/SaPRwBhXyyVCHg2zlybAHS/zICiM+MC1KXBjmrk8Xpzc/v9xpVwiyADl8cdIX4x8GyWDcU+AIhdi5ALlCVAeX5T0Rf+cJ2K5P3Z/ao1ovjHbfHO26eZsc//cmVu8bjrzM/nlc01Xx4mOIV+H26LdfSqnDFm0D/lt8dt+IqeNY2CaaHV6W53zra75NpctzvkWp+VtLm/Lb3d6W+3G2vnFuVuTROfwyUs+h9vbOey/cGfh/MiCw+3tGPJfGAmeHwk47F84Br2/aXd7290+x+0ZIrSWWNpIv19PRhJg8RsViEQDkegqxXzaov0r24HI7mosF97eW42zXxLgawJE4uzy7v4KxcwvbxIKFOU8L+f5iokUKApsTgQ5ZOiAl6nEj3gyI8marsplZBwYhq4byNBRUSkf6LnMHpFIpjL72WgsJoowTe/phpWCoolSUVIPuLwKBGl7Z3fvRyYraBTNpPY5mqbzUF76GCYQQmU79XrdNM1arVapVGq1Wr1WPapbs16vVquHpVKJF2XAy1JBkyCUJInjeAJjjBACAPBWBI7jEEIQQlVVBVEsFjVVO4RySVGUZDJJp9M0nWYYDkLVNE3rWJaleDwOAAthEQAulUpls/uaVgJAyOWymQyTYwDLKoVCUVPVYzuNBjZ04yfebaRUMlMKEgAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/d2d843708a31ca777bf6ce1dc71564bc/17d73/1098.png" title="attaching the event listener to each of the button" alt="attaching the event listener to each of the button" class="gatsby-resp-image-image" /> </span>

As you can see, when we click the button we get the event.

Now let's grab the button that was clicked, and then save the answer.

We will need to use `await` so let's mark the function as `async`.

For the question, we will want to pass the title whatever the button text is. To do that, we can use `button.dataset.question`.

    async function askQuestion(e) {
      const button = e.currentTarget;
      const answer = await ask({ title: button.dataset.question });
      console.log(answer);
    }

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:565px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:82.93333333333334%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADeUlEQVQ4y3WU209cVRSHz7u+SJqaRnuxf4AvvtQCMemzJjYYuQRppSYMaWsUob74WJJ2hpmBNmooAl7KJZiQtFU7UAtKI6XMTGEIMPc5dJj7mRtzYKY0wGf2GRirlZV8+a2s3z5rr30ellQoFNjc3ERVVZRkipUnq4QiUTw+Py63F7fHx7LLg8cX0Goerx+311fMfX7iShIllUb2ekgnk0gVbX1UXuqj8st+Ki71cbK1l/LWXt5u6eFES09RP7/xHMX6iZYbmlfe2kd5Wx8nv+ihoq0XSdcxhE4/WKLZOEyzYbCErmOQZtMQzUbhDb2I8AXGokoTn3ZjefcKYx8YGXvfwHi1ifFaE5bTesbeu8rD9hGWFuZYtFpZtFlZsM3isFtxPP5/pN8/6+a3Kj2WOhN3q41Y6s1YGrr4pUrPzIXvkW/bSMQjRGWZTDxO0OnFNj3NnN3KnG32BaSmziFKmAfRXRtG1zVMo/EmV2/e52eLg9EJJ7fmAoy7onw9+heNl/u15+oMAzQZBtCJX6PpAFJZtZ5XqvWUVRsoqxGq50BNBy99eIVTF36kteonLp4boW3EylejjzndPsrLp9s5UGekrLaDshrDP9QakI593MnRs50IfZ7DZ0y82fQNp85/S8XF76hs7eedth9463w3hxtMFL8z79K5ixnptQYTrzeYKKp5NzdqeugjIwcF9R0crDPwap2BQ/VFbz9KEx7VpjJzrLGLNxqvaYgbhX/83HWOf3JdOyM4csasvWCPI2fNGsKTfn1g5+70PEKnHF7uTNm486dVY9Lu5N6jBW7/8YhbkzNM2pe5N7vIpN3FA4eHqfki961LTNidWh8pHg0Tj4SIhVd5ml8nEQ0TlP0a2XSalVCS+UUftnkXoWiatXSKvJplXc2h5lTUXI71tQzqWoa0Ekdyud08CQZxudwoShKf389aLkcup5JKZ4gpGVKZdSLxFOGowuLSksZKLIvDKbMUiLC07CShKDycmUHKZDIEZJm9xqFQGLEwNjY2yOfzFPJ58vkNjUIhTy6XI5vNEkukWI3EicQUEokEsViMpFgO29vbeH1+wpEIiYRCTlURsbOzw46mu/muihDbaTUYRA4ENI1EIsiyjOglPd18RjweLx0WIYxik3+zVxcNxeViKjGdoihEo1G2traQCs+2SxPt1+i/7BfC+xt/3BEUiIxipAAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/9b29116c2b27647f5d1b4b96a1ce16aa/07eba/1099.png" title="button submitted click resulting in logging the typed value in console" alt="button submitted click resulting in logging the typed value in console" class="gatsby-resp-image-image" /> </span>

As you can see, when you click the popup for name and enter a name, we get the value back.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1045px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:16.799999999999997%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtklEQVQI123Mu07DMACF4bxCqqpWYuLQZqgYwkVCIc7FTt0a1xWUmYUnYOL9pR9RCbVDh284R0cnEU1AjgeU3nI7bJCTJ+s9Rbvnpo2UrUdqx6J1iMYhXhxCO6QOp03ZHch0ROjI/NGRLJ49Kn5SjJGqGZBmS745snz9RoUf7sIX62Fg2Rmq3qCmHdm4I+88hQ0ou6eyH6zskbJ/I/l7l+ad+ZMjvbfM/tXjSVqbc3dFWl/kh4lfbbFfFf/MyBgAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/dda1db70d8b7b1924c7153e0a9a4d1c2/8f0f9/1100.png" title="adding data-cancel attribute to button" alt="adding data-cancel attribute to button" class="gatsby-resp-image-image" /> </span>

Now we need to check if someone has passed the `data-cancel` attribute. To do this, we need to pass `cancel` to the options object we are passing to `ask`.

How do we tell if the user has passed a `data-cancel` attribute?

Let's try logging the dataset.

Add the log within `askQuestion` shown below ðŸ‘‡

    const button = e.currentTarget;
    console.log(button.dataset);

If you refresh the page and click the age button you will see `button.dataset` logged to the console.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:545px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:76.8%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADdUlEQVQ4y2XT3U9bdRzH8fOXgEB0Jtv0ft54gwrERJywsQe80BsHGx1QVp7G5GHOSQZBcDCzgVvirRdmeqEGlbnyVKD06bS0paU90KdzTmmB0kH7Nud0sER/ySuf3/fi+02+J78jNPcMcr396wLTHZq77mIw3eFmxzBf9T/gdu84A73jet7um6C3Z0zX3TnM9Z5BWvuHaOl7RZhoGmDonSsMv9tYUN7EvTNfYH86g9O5imN5GbfdhstmxWFdJhzwo8oxPHPLTA6P8eTJFI8nH/F4qkCY6Brk27oORi9368Y+62HorBHLr89YC63j9ntZC/hxezw4nC5i8QTbuzusPrfw/b1Rpn6YZPLhQyYfFQiV13qpNPRTaeijqqmPquYB3v+8k/npRcjkyMd3IZXl6OQOc3rO/b3IB5dMVFztpeLKLSoavtRTKP64laJqTQvF1S0UafWHBn4f/wWx/D7LZ4axln/HuugjKIUIBINEE1GmfzNT8t41imra0GYUny0QTpy7ge78y6wz8UZ1M+Yfp9nqeoq/+ScCXT8T9QWJSRKR4AapRIzZP+Z5s8rAiQsmjmecu4FQVmNEU/pJK0f3ko+aqb/6DYa+BzTeul/QNkKjcYQG4whNplHqG+5SVt1CWW3bcZ9GOH2pk9OXu3irvptTFzvR6rc/vcnrde2UaGtUt1Ba00bZeRMltW28VmPUldYaOXmxg5MX2vU89ZIwu2TDbFnlL/MiK641FqxO/ny+wLO5JRZWHLjW1vlnzsKMeZ6FFRs20cuSTcTlDWB3+7F7/FhdXix2UU9ha1NiSwoT3giynVRRFZlgYF0XjWwRSaRYcgRYsK6xKoaJJVSURIx0KoWqbqOoSZKqiion9H7BJYpshEKsWK1EIlGcTheRaJRUOo2qJoklFGR1G3U7TViKEApLzJrNSDEFu1di1RPG6fETCKwTCoURUqkUe3t7umw2e5yaF9l9cgdZDl/sc5jN6PX+foGsqATDEZ322MPhEPF4HEF7pJlMBlEUCQaDyLKs3+OxKF5JYcYZYdarMO+W2dySSaoKsqzg8/nw+30oikwyqRKNxtjd3S0M3NnZwTdrZtNhR96UCGjru0VCHi92swW3L4SkZpDVlP7t0um0vsnBwQH/PcLe/iH54/8q90o+D4cHkDtqyv+vOZ/Pk8vljmn1v7tSpzWkwqyoAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/48d41f4008a9854db7b0f0bd999b3853/3ddad/1101.png" title="clicking age button logs `button.dataset` to console" alt="clicking age button logs `button.dataset` to console" class="gatsby-resp-image-image" /> </span>

Why is `cancel` an empty string?

Because we didn't pass it as `data-cancel="true"`.

The way HTML attributes work is that simply by existing, they're true. By not existing, they are false.

In addition, trying to convert a string of "true" and "false" is a bit of a nightmare, so instead we will just pass an attribute with nothing in it if it means we should have a cancel button.

To detect if it is there we can add the code below ðŸ‘‡

    const shouldCancel = button.dataset.cancel;
    const answer = await ask({ title: button.dataset.question, cancel: shouldCancel });

If you refresh the page and try that, does it work?

The answer is no, because `shouldCancel` is going to give us an empty string.

Is an empty string `true` or `false`? It is falsy!

So if we are passing an empty string, it is going to be falsy.

You might think you could just put a bang in front of it as shown below ðŸ‘‡ but we still have the issue with an empty string being falsy.

    const shouldCancel = !!button.dataset.cancel;

So how do we detect if there is a `cancel` property within the dataset? We can check using the syntax below, because if it's not true, it won't exist .

    const shouldCancel = 'cancel' in button.dataset;

What is that syntax?

Let's say we have an object `const wes = { name: 'wes'}`.

We want to check if Wes has a name property. We are not checking that it is there, but simply that it has a name property.

    'name' in wes;

To check for that, we can use the code above ðŸ‘† which would return true.

If we check for a property that doesn't exist like `'asfdas' in wes`, it would return false.

That is how you check if a property is there on an object.

We cannot use the other methods to check because sometimes a property is set to a falsy value such as an empty string or a 0. Using the `in` syntax solves that issue.

    const button = e.currentTarget;
    const shouldCancel = 'cancel' in button.dataset;

    const answer = await ask({
      title: button.dataset.question,
      cancel: shouldCancel
    });

Let's refactor that and rename `shouldCancel` to just `cancel` so we can use the shorthand syntax.

    const answer = await ask({
      title: button.dataset.question,
      cancel
    });

*NOTE: In the video, Wes pauses it to specify that he could have used `button.hasAttribute('data-cancel');` to check for this but he decided to leave this in the video because it is a good lesson on how to check if a property on an object exists, regardless of which value it is set to.*

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1500px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:48%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGElEQVQoz6WSzYoDIRCEdXTU/JySQDRGwdHEdpw2kLz/uy2MWZaF7Gm/Q1EUVNM0Tch/YIxxzgkhwzBQSrt2MwxDz7v5gLX28XhM07QsSyml1mqtBYDn8xlj9N7XWu/3e0ppnmelFGOMUvouXy4XRGytIWLOubUGAIhYV3LOMUYASCkhove+lLLf799lrXXOOYSQUhJCEEJ+Bv/2H+Cc73a77XYrhJBSqhUppRBCKdXDcRw555vNRq6M4/i+gjGm7zzPMwC01m6327IsXfvy/Rav16t+45xjjBHvPQDEGEspiBhCmKYJEQHArGitAcBaG0Jwzl2v11IKAByPR3I4HJxz3nutdQjhdDpZa40x5/P5Xy9A/6a/wxdjoiZoe6w5uQAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/d61485363d75c1bf91cbe21813670639/aa440/1102.png" title="instructions for `data-cancel` attribute" alt="instructions for `data-cancel` attribute" class="gatsby-resp-image-image" /> </span>

If you refresh the page, that should now work.

Let's hook up the cancel button.

Go back to where we created it and under the TODO comment we will create a callback function which resolves the promise with `null`, and then we will call `destroyPopup` because we want to completely remove the popup.

    skipButton.addEventListener(
      'click',
      function() {
        resolve(null);
        destroyPopup(popup);
      },
      {once:true}
    );

If you refresh the page, you will see that it is still working.

That is the basics of the pop-up.

The last thing we will cover is how to use the popup to ask questions in series.

For example, let's say someone is going through a form and you want to popup something and ask three pieces of data before they can continue.

Let's say we had an array of questions like you see in the image below.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1126px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:29.599999999999998%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABH0lEQVQY002N2W6DMBBF+YJiOyLGQGhVkaemwSxpWhwTG7yEIHVRgPb/v6SiyUOl0dG5upoZhxTqft+sWfVQtYm8rOVXIi+klGHJ3Y2EWwmeBUwFTCWkzcxUoj/CVDqkUF4mw1yF8v3RXKLKJP2ZHNTytfVrvawUEQZz5VODthJsBUiFe711W6aSUIvFp3/8WhRtZI3PNa5UpAyp9cpab994u3PYDh7rY6oTaoLMIto4fq5wLuLSBs0w1y867k/kaDDTkT4FwsRdhw961Z190QVlv8wUTtsFbefP0c6Gb92m/wD8G9U/kI/oOMF6ugmfrhGJERwGxCaXDXdsAGwEbHTAE1+kguyVmxmQGVBYl9pZcuv+I8jszMLC25xgYX8BCaxGK65kMiMAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/4092c15dd65289255be968f714e9fbcf/b94e3/1103.png" title="array of questions in code" alt="array of questions in code" class="gatsby-resp-image-image" /> </span>

How would we ask them in series?

You might assume we could use `Promise.all()`.

For each one, we want to pass the `ask` a different question from the questions array as shown below ðŸ‘‡

    const answers = Promise.all([
      ask(questions[0]);
      ask(questions[1]);
      ask(questions[2]);
    ]).then(answers => {
      console.log(answers);
    });

This is not an uncommon thing to do, waiting for few promises to resolve and then getting the answers.

We have to use the promise syntax because we are not in an async function where we are calling `Promise.all()`.

If you refresh the page and try that, you will see that the questions are asked out of order. What s happening is there are actually three popups on the page at the same time.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1500px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:68.26666666666667%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZklEQVQoz5WR7U/TUBjF+z/xgcBWJJRt7UZfNtmGURJNTAxqDInRCWII/i8Sv2xjjrAXBht7A1FDpiYgEzaoG1vpvb1dHWylt5jFxG9g+OU8387JeZJD5De307liIr2xvLoeTaQi8dXISjIUjS0Gw++C4cXg0mIwHIrG4msbqWzxn1Yz+URqnei3saSDc9KC0yE4acFFCwznHvffmwsszM28nXkx/ybw1uefdHBuhvf8lZP3DNF8v40lBuzcCM17x26P0+5xxu1lPDwvTE89KxdKR9/LzcNf8Eft+ZNpzi34/RNen8/r8/v8fsrlHrDzhIVirdSYhREGGWHQwVtd7r4R5s79R5WnEXE+pSCldSRNPnjcN0xb6Z7BYuctds5KsRY7T9yycSTFkqPcsEMYtvOkQ7DaOIabCDx8NTv1OhCYn3254PLctVBjJC1YaIEcZUmKHaLYITtPJFNra+nMRq4YWlqORGOZXGEllliJJxPp9PtQKBpPLCeS4Q/RdCabyeYLW9vFzY+F4lYuX1zPZAmtpakIqVq7JiEZnXcvsK53dV03TVPXu9jAJsbdTgdjAxvGpWle9s7EGBuGQWhAU5sQNUTQQHpXv7wJBJRA9UtFg6raUM60joFN0+y1mQb+f/jCuEBNpJ3CNmoqSvuwigBqI1nT4G9s4O7Zdb8Q2MRABKAiKeK+1ADf9mBpFxzVVCQhab9xrp5dFwYKOC6LtXJV3P1c3quWdsTSzvHBz1r9QKx+rUAIAQDqFRBSQyp/2j+p1BX5RJZgra7U68rpqaLIUJEgAFCWQesKiE6ro0kts7fBjfkDBMd7lcmG2fsAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/135a1c17510182ac1e9dae73017487a4/aa440/1104.png" title="questions asked in sequence in the html elements tab" alt="questions asked in sequence in the html elements tab" class="gatsby-resp-image-image" /> </span>

That is not a good solution, we do not want to pop them all up at once.

`Promise.all` will fire them all off concurrently at the same time, which is often what you want but when you want to do it sequentially like we do, you cannot use `Promise.all`.

A better way to do this would be to take your questions and map over each and pass in the `ask` function.

    const qPromises = questions.map(ask);
    console.log(qPromises);

If you refresh the page and look at that in the console, you will see we have an array of three promises which have not been answered yet.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:910px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:51.733333333333334%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjElEQVQoz3VS2W7CMBDk//+LFwSIByQgnIHcMY6P2LmAqXYpLVVbSyNfu+P1zI7u9zsIr/F44N8xDAPyPEeWZViv1yjLEkopxHGMIAhgjMHoFay1RnwJ4b3DdrvFfr9nXC4X1HXNM5FMJhPMZjNsNhue5/M5ptMpxuMxoih6EhJJlheYBwKuaVFJya+nacoVOecYdCalZNxuN3jv+ex6vXIcYfT4/GM/DNgfLVrfYxh6tG2Lrus4se97rpJIm6Zh0J5i3oe19pvQtx5pEKEqKiit+IthGEIIwTqRRoTj8YjdbscoioJzyQPiIdm+CJ13KGMBZx1fJHGCJEkgZcUvE9HhcGCdzuczTqcTf/1p5JODTfmqsPFIDymUVNBWI4opMYS4Pp0ko1arFRtFa6qQ9PuXkFpCCw0jDKyskUckskBZGPR9x8ITASVVVcVrMuUX4fvB0A4wmYWKNExu4FwHo28/hKfYx1uzvu9/VEi6WWPhpYfODKpIoRY1GmqpLOO+WywWWC6XbA65/xfhB/CJ+f/Kf8SxAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/3d71249638a5518211d6f50a1cf2a6ee/c6bbc/1105.png" title="array of 3 pending promises, which needs to be answered yet" alt="array of 3 pending promises, which needs to be answered yet" class="gatsby-resp-image-image" /> </span>

What we can do is loop over the array and for each one return a promises to get an array of promises.

Then you can wrap that in a `Promise.all()` as shown below.

    Promise.all(questions.map(ask)).then(data => {
      console.log(data);
    });

That will loop over each of the questions, pipe it into the `ask` function (which will return a promise), that will return to us an array. We wrap it in a `Promise.all()` and then listen with a then. This will actually work.

We still have the problem of the UI popping up all the time so that is not what we want.

What we do want is to map over it, but asynchronously.

    questions.forEach(async function() {
      console.log('Asking a question');
      console.log(question);
      const answer = await ask(question);
      console.log(answer);
    })

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:926px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:93.33333333333333%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC2UlEQVQ4y3VT147cOBCc//8sn7G+gw17cTPKWQwSlRgkihox6KDRPtjAbYEgmgCrQ3X3zTmHEK6qCmE8TdM8C4xxWVbDMCCEuBBd1xFCIISMsWmamqaBEFprj+O4aW0I6RDCECFCiOCirgEAYOgHiDBjvCqroijTJG0wRhAWRZHnudbaWntzzh2fY991mhd5DbwgwISgrgujKAiCfd/PyMdxdF3XNA1CqCyKidKt7/p//uZR+GR0JYSVZffrpxzGwffwt7cxDFsIL9c3a+08z9NEp4lyzqWUT7UJ0s19LzlXnG+MLYSoRW6Mr32vxMy5sNY6527GmDTLPM+Pwriq62EYH57/7/0BIArCsOv7JM3iNLvfHxWAFQBBGAZ+YLQ5ye6F4zjcdZwz1l3GcRzGWNL3w0QhwnxZqBDtS3ljXuTj9W+ehRAzpVRtmxFcVcWz761SktL0cY9/fE98v3o88vf36Oevoig3pT4Ea5omz/M4TqIo6oZxxGP29Xt7f+ycr323EcKjyKwr9bw5y/ZlkVJu23aSnXPbtqETmLTtsmwAibRmJUDGms9aeBX7aZ+vGdJGF1VeVkUYRQghUNdJnARBoLU+3CttMQs+cgoniicKphGMcpFqVYLwoerT96R45GVcUEoZY4wy8WrVR9pylXKWFEwM0S7vxnKYxcIol+MylD2HjNaTYuv/pG2MyfPCD4IkS1GDKWdJlnqeDyCMknigY17mWZF5gQ8AqOs6CALf98+0rwlbpDzPJaPaGOOcc6XUPC/rqkhLSEsQQtNEx3Ek5LQ/FuNjAYzWxjyfT/unfvu+p1mWF6dguGkQxukLH5HPxSBdnWV5FKVxTJrmlFpru+/OGLtt5613tz/1umqlfvd+ktd1Zb5Pvv41V9WK8dq21HuwKFJ93375wtNkqWvy9sZ9f6ireVmuRp6CSWWuwbbWWWutsfYMpa0x51tr+yrPGHMR7G/4D/HCKJc/GMaLAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/a535bf1b0854cae1facd53fca309d2a6/69476/1106.png" title="script executed immediately without waiting for other question to resolve first" alt="script executed immediately without waiting for other question to resolve first" class="gatsby-resp-image-image" /> </span>

That did not wait for anything right? They will resolve, but they all three ran at the same time.

So how do we make an async map function?

We use a `for of` loop.

-   Make an async function called `askMany`.
-   Within that function, we will have the `for of` loop which loops through all the questions.
-   Inside of the loop we will have `const answer = await ask(question);`.
-   We will log the answer after it.

<!-- -->

    async function askMany() {
      for (const question of questions) {
        const answer = await ask(question);
        console.log(answer);
      }
    }

    askMany();

Now when you refresh the page, you will see the questions come up one after the other and are submitted sequentially as well.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1500px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:51.46666666666667%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVQoz23Ry2vTABzA8ZwVMVlqk7ZroTAEWc26JrZN03Z5tOm2IpkIbqsMRLu/wYt/gYKwKqIeZCeZkx4n66rgAy/iZVadCkX7zpKKpmtM0tZGdHUUFL7XD/weQGb19fVbL6/dfJF59DaTf38jv7OSe+eZXQKxKSQQR/EYPBkDMWY/aL+JQcDDq8/WLm8+uLKVe1V5/FF6siNtFmqnhAsQRqHBhMPP2wIzVpxBcNrqo2GchQkW9v3FwMUscCkLpLPA0jqQWgNS68Di/cP+s6ME4yITriDnIJPOYNwdYt1kxEkyNiqGkrw9MIsQceB27s2drUJmY3tlY/ve0w+rzz/dzRc80ykLRo1SSRuZsOD0CM5CE+x/xm6K1Xr5syyKakvpqEpXbX2TG5Rw/qiHdjBnkCiPRnk7E7dFZlCCt3q5A/kbf99r78qyphs/+6YoyeVKtVKtc/NpcDyE4gmrj0WIKXiSgbz0MBvgTrejKqq2pxk/DLEsSpLUbH5l5tMjJ0PHqcRYVBgLx93haVd4zuLjQS8LebmDgLaqNmpiu9XudXtSY1cURVmWuYXlQx4GoQVHRHBGBDuVPEbOwf7TEJEcDlAU5UuppOu6aZq1er1YLJZKJW5hGRwnUZwBMfrPh2kQo4dPNRjb6PQ0Tev3+6ZpGrqh67qqquy59JETQRvB/rvnMP4F+1f0FPl8lvcAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/0b6c1129e54fdfa3382392f3b3fe5dd5/aa440/1107.png" title="making async map function to make questions come up one after the another and submitted sequentially" alt="making async map function to make questions come up one after the another and submitted sequentially" class="gatsby-resp-image-image" /> </span>

The reason for that is unlike `map` and `foreach`, `for of` allows you to pause a loop by awaiting something inside of it, which is great.

One thing Wes likes to do is make a utility function called `asyncMap` which does exactly what our function does but returns to us an array, like a map does.

We will be using generic variable names here to make the function as flexible as possible.

    async function asyncMap(array, callback) {
      // make an array to store our results
      const results = [];

      // loop over our array
      for (const data of array) {
        const result = await callback(item);
        results.push(result);
      }

      // when we are done the loop, return it
      return results;
    }

Now we should be able to replace the `askMany` code, and make a new function called `go` which we will mark as async to allow us to run an await.

    async function go() {
      const answers = await asyncMap(questions, ask);
      console.log(answers);
    }

    go();

Now when you refresh the page and look at the results, you should see that we get our array back.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:712px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:182.13333333333335%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAIAAAAGkY33AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFJElEQVRIx32UW28bRRiGt1KrND+nNOUGgSK1IHHDDRf8AUqbIFToNTdtk78AKj3ABQKJi8Zp0iBR4iQ+tI4dH+JTYnsP3vV6zzs7ez7vovXabdI0vHpkfTPfvJ7ZmW8GyTXo3Ry2W8AT8themdzdJ9OenaRJFQfCeSDSyg724c/DT58ObzwhFh9RX/xOfv4bcf0xsfgI//gh9dWfURDGcRxH8Vkhwo8vB9d+Qq8/QT/5BV18jH/2K7H4GLvxFP3oIXr9yfDLPyIvONfcaDEHu2g1j1fzWHUPrVWoWpms7mG1AlHNYfUDqkUr7XNA5r97Pn938y13Nua/35i/uzH/w8b83c3Ld55fXs7MLWcuL6/NLWfmltZmzSRGkJtryNdneTZhLcneyiC3Mhe+yVyYBMgkSEEuLWUuJqwn3J4FS+uT/vVLU9L+TNq8eDsJLi5lkLnl9VN8e+J3yvMTnBqMTBd5c7bUm2tTpvGzCe90zrj64N+rK9tX7v2zsLJ99cH2B/dfXrmXcG01u7CaXVjZvraaTQdcuf9yYTWbZlMQjmMpkjQMnSKHBI7JkqhCRYWQGdMsw3Asy4zHgsDrmgoVhWMZTYWapmoa1FQVwQliZ2dXVbVK5eDwsMmyHFAS5fP5bHYnm81ubW29LpVMw+AFoV6vQwjVmRBRFFmWlSRpNBqNaFqWxDEntoewS+lNXElpYKCJybwgKQBIJ4T0B4Nut6soCkEQ9XodTIQTJIYPZQABVIECgaIqUIWqenJaCCHSaDQqlYokSa1Wa3PzBc/zAIBqtZbL5RQFQKi84R0BABAIIQBA13XTNDVV1TQNQmjbtmVZ2hmZpmlMlAZIHMdBEHaPjl5s/b2dzbba7VarnS8UWZZL7lI0vU1pgOM4RVEYhjWbTQzDkWAiABSO42UANF23LEsUJcuywjAMTksUBUEQOI5jGIbneSSaKD5H72RpmmZYhhpRvd4xSZJImrRt23UdS7VszTYV09Isx3Bc042iKAxDW3csaLmmO+gO0GO03+n3j/skNTHHcSwIApABIOXRAUkfjohXOP4Kp7u0KIsczQkoPzwgqBo5rtNEEWcOxyY0kpdE0cz2gLFs17RMSZaTw1STk9ENPYojP/CDIJgtPwqCwPM8z/cdx3FdFznCuId/ve70iFxuby2zXq5UOp1upXKwXy5H4exro+kb1m63e/1+q9kqlUrtdhvx/UDRLN/3XdcNw9APgmQG3/cmzSAIwonSIKmFiVRVnZ7z2R2OJxuRbkcYTjecYdlGq4VieK1aq9Xro9EIeXMekgyOjo8N0xJZVu31tMFAwzDPtkNT1wZ9Yb/ElEr4zg5ZKPAMoxtGcqtS83jM9Or15v6+LoocjsPjY75YlAd9XlYJztNZzqBIk6YdhvE0zTDN6bv9pvZsBcjtQwMdgFZTrB34EIoCL0GzgrquH52tnCiKkJOly/Z4gRJMz+GPjtTDQ2Y49PxgOjoMk68Pw/hEzZ0ya7wmc7IX+AqOw27HlqTAcSxd933/vcV7yqwLmjDibc/lOx2xvM+9KgrFAtNseucU/ymzqZgmNG3H1gTBkSRbFA167MqyCuF7L88ps8qpPM0HcahgqHrUgd2OUitLjYZpGP83c1p9ru3JQxnSUB3r4ki2HWc4tAI/eu/1PGFOcnHgByawdF43RMNQDM/zFOBGYRQEfjirOddxPc97a07/j6ZpQzdczQUkgDSUcdmSLceyNU1rNBooipbL5UajUSgUURRNXf8ByBH74oD1ojoAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/00f8f62ac0931ec85c90e24d1bf3fb5b/3d4b6/1108.png" title="clicking on submit will log the array in console" alt="clicking on submit will log the array in console" class="gatsby-resp-image-image" /> </span>

We could take things one step further and refactor the function slightly to push the await of the callback directly.

    async function asyncMap(array, callback) {
      // make an array to store our results
      const results = [];

      // loop over our array
      for (const data of array) {
        results.push(await callback(item));
      }

      // when we are done the loop, return it
      return results;
    }

Find an issue with this post? Think you could clarify, update or add something?

All my posts are available to edit on Github. Any fix, little or small, is appreciated!

[Edit on Github](https://github.com/wesbos/wesbos/tree/master/src/javascript/12-advanced-flow-control/72-async-await-prompt-ui/72-async-await-prompt-ui.mdx)

[**â† Prev**](https://wesbos.com/javascript/12-advanced-flow-control/71-async-await-error-handling/)

Async/Await Error Handling

[**Next â†’**](https://wesbos.com/javascript/12-advanced-flow-control/73-async-typer-ui-two-ways/)

Async Typer UI - Two Ways

### <span class="highlight">Syntax Podcast</span>

Hold on â€” I'm grabbin' the last one.
