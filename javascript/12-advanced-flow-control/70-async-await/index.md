






(https://wesbos.com/javascript/04-the-dom/built-in-and-custom-data-attributes)
    1.  [Data Attributes](https://wesbos.com/javascript/04-the-dom/built-in-and-custom-data-attributes/#data-attributes)
-   [Creating HTML<span class="videoNumber">Part 25</span>](https://wesbos.com/javascript/04-the-dom/creating-html)
    1.  [append method](https://wesbos.com/javascript/04-the-dom/creating-html/#append-method)
    2.  [insertAdjacentElement method](https://wesbos.com/javascript/04-the-dom/creating-html/#insertadjacentelement-method)
    3.  [Generating An Unordered List](https://wesbos.com/javascript/04-the-dom/creating-html/#generating-an-unordered-list)
-   [HTML from Strings and XSS<span class="videoNumber">Part 26</span>](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss)
    1.  [document.createRange() and document.createFragment()](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss/#documentcreaterange-and-documentcreatefragment)
    2.  [Security and Santization](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss/#security-and-santization)
    3.  [XSS (Cross Site Scripting)](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss/#xss-cross-site-scripting)
-   [Traversing and Removing Nodes<span class="videoNumber">Part 27</span>](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes)
    1.  [The difference between an Node and an Element](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes/#the-difference-between-an-node-and-an-element)
    2.  [Properties to work with Nodes and Elements](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes/#properties-to-work-with-nodes-and-elements)
    3.  [Removing Elements](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes/#removing-elements)
-   [Cardio<span class="videoNumber">Part 28</span>](https://wesbos.com/javascript/04-the-dom/cardio)
    1.  [closest method](https://wesbos.com/javascript/04-the-dom/cardio/#closest-method)




##### <span class="grit">Module 12 - Advanced Flow Control</span>

-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/66-the-event-loop-and-callback-hell" class="currentModule">The Event Loop and Callback Hell<span class="videoNumber">Part 66</span></a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises" class="currentModule">Promises<span class="videoNumber">Part 67</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises/#then-method" class="currentModule">.then() method</a>
    2.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises/#promiseall" class="currentModule">Promise.all()</a>
    3.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises/#promiserace" class="currentModule">Promise.race()</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/68-promises-error-handling" class="currentModule">Promises - Error Handling<span class="videoNumber">Part 68</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/68-promises-error-handling/#promiseallsettled" class="currentModule">Promise.allSettled()</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/69-refactoring-callback-hell-to-promise-land" class="currentModule">Refactoring Callback Hell to Promise Land<span class="videoNumber">Part 69</span></a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/70-async-await" class="currentModule currentPage currentSection">Async/Await<span class="videoNumber">Part 70</span></a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/71-async-await-error-handling" class="currentModule">Async/Await Error Handling<span class="videoNumber">Part 71</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/71-async-await-error-handling/#handling-errors-with-higher-order-functions" class="currentModule">Handling Errors with Higher Order Functions</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui" class="currentModule">Async/Await Prompt UI<span class="videoNumber">Part 72</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/#running-an-event-listener-only-once" class="currentModule">Running an Event Listener Only Once</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/73-async-typer-ui-two-ways" class="currentModule">Async Typer UI - Two Ways<span class="videoNumber">Part 73</span></a>

##### <span class="grit">Module 13 - Ajax and Fetching Data</span>

-   [AJAX and APIs<span class="videoNumber">Part 74</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis)
    1.  [What is an API?](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#what-is-an-api)
    2.  [JSON](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#json)
    3.  [AJAX](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#ajax)
    4.  [Public API list](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#public-api-list)
-   [CORS and Recipes<span class="videoNumber">Part 75</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes)
    1.  [Query Parameters](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#query-parameters)
    2.  [CORS](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#cors)
        -   [What is CORS?](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#what-is-cors)
        -   [CORS policy](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#cors-policy)
    3.  [Babel](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#babel)
    4.  [Browserlist](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#browserlist)
    5.  [Proxy](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#proxy)
-   [Dad Jokes<span class="videoNumber">Part 76</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes)
    1.  [Headers](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes/#headers)
    2.  [Getting a Random Index](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes/#getting-a-random-index)
    3.  [Loading State & CSS Loader](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes/#loading-state--css-loader)
-   [Currency Converter<span class="videoNumber">Part 77</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter)
    1.  [Caching the Rates](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#caching-the-rates)
    2.  [Converting](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#converting)
    3.  [Hooking Up The UI](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#hooking-up-the-ui)
        -   [Input Event on a Form](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#input-event-on-a-form)
        -   [Wiring up Handlers](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#wiring-up-handlers)
        -   [Formatting Currency using Number Format API](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#formatting-currency-using-number-format-api)

##### <span class="grit">Module 14 - ES Modules and Structuring Larger Apps</span>
##### <span class="grit">Module 15 - Final Round of Exercises</span>


<span class="grit">Async/Await</span>
=====================================


JavaScript, Async/AwaitEdit Post

Although in the last lesson we refactored our callback hell example to use promises, the syntax still isn't that great because we are nesting at least one level deep inside of callback hell with the `.then()` syntax.

`async/await` is a new syntax that will allow us to use the keyword `async` and the keyword `await` for a much nicer, easier to read looking code and we will see how that works in just a second.

Your functions that return promise still stay exactly the same way. There is nothing that needs to change about your promise generating functions. We need to change where we actually call the code to use `async/await`.

Go into the `playground` folder and make a new file called `async-await.html` and add our base HTML.

Add a script tag and create that wait function we have built a few times now.

    <script>
    function wait(ms = 0) {
      return new Promise((resolve)=>{
        setTimeout(resolve,ms);
      })
    }
    </script>

Now if we want to use the `async await` syntax there are a few things that need to happen.

First of all, you can only use `async await` inside of a function that is marked as `async`.

Make a function `go()` which logs "starting", and "ending". In order to make it wait for two seconds between the logs, you would add the following code 👇

    function go() {
      console.log('Starting');
      wait(2000);
      console.log('Ending');
    }

    go();

Now we know if we run `go` on page load, we will get "starting" and "ending" immediately.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1122px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:10.4%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZUlEQVQI123MwQrDIBCE4bz/S4ruWlNpoocmqSv4lya9FDrwMXOaaZ7veB8opdJ7p7X2w8w4Xo3nftmOq30QVIUQAqqKc46cM9O6Fm4pYdb5ZIzxF3ydG5blQYzxPEspISLUWnkDjhiZibLx6vcAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/e571a50629e8efd6ecef096005a78705/62a6a/1050.png" title="starting and ending log in the console" alt="starting and ending log in the console" class="gatsby-resp-image-image" /> </span> 2:32

What async await allows us to do is put the keyword `await` in front of a promise based function and it will sort of temporarily pause that function from running until that promise is resolved.

    function go() {
      console.log('Starting');
      await wait(2000);
      console.log('ending')
    }

    go();

If you modify the code as shown above and then refresh the page, you will see an error in the console.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1142px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:6.666666666666667%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAASklEQVQI1wXBgQmAMAwAQfcfTSiipIqxtk2MIIIzvHdDSKGNMz0JroblQtSg7U6ajJQfFgmOXClbx/TCj6DeH1kNUWMtjmjn9JcfQWFHdjjAbUkAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/e0ded0a0e4e6a7c24cf88fb2fc5ab868/b490f/1051.png" title="uncaught syntax error: await is only valid in async function" alt="uncaught syntax error: await is only valid in async function" class="gatsby-resp-image-image" /> </span>

> Uncaught SyntaxError: await is only valid in async function

To fix this, we need to mark our function as `async`. That tells the code that somewhere inside of the function, we will be doing some awaiting.

Mark the function `async` as shown below.

    async function go() {
      console.log('Starting');
      await wait(2000);
      console.log('ending');
    }

Now if you go ahead and save the function and then refresh, we will getting "starting" logged to the console and then two seconds later we will get "ending".

That is beautiful because we achieved that without chaining a bunch of `.then()` .

If we wanted to wait for another period of time in the same function before executing something else, we can.

    async function go() {
      console.log('Starting');
      await wait(2000);
      console.log('running');
      await wait(200);
      console.log('ending');
    }

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1152px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:12.8%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAdklEQVQI122O2woDIQxE/f9P9GFFbczTlrWURvEyxbTQ0u3AYWAShjGJGUfOqLVCRFBKOZHvgj0LrrcP+/EAJQYzI4SgTkQwIV60bGnOiV+do3cwhxYs3Lape+9hKCW9994xxvhL79+8/lprumyVWGsRY4RzDk/Iy+cQ9ZYjoAAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/3c61062b863f21b6e37a19a6dfeab2aa/4ad3a/1052.png" title="starting running and ending in console" alt="starting running and ending in console" class="gatsby-resp-image-image" /> </span>

We are now able to just stick these calls to our `wait` function wherever we want within our `go` function and the execution of that function will temporarily pause until the promise has been resolved.

Marking functions as `async` can work with any type of function.

Let's go over all the functions just to demonstrate.

You can add `async` to a function declaration as shown below 👇

    // Function Declaration
    async function fd() {}

You can also mark an arrow function as async 👇

    // arrow function
    const arrowFn = async () => {}

You can also mark callback functions async.

For example, if you had an event listener, you could make the callback function async as shown below 👇

    window.addEventListener('click', async function() {

    })

You cam also make methods async.

    const person = {
      sayHi: async function() {

      }
    }

You can also mark methods async using the method shorthand and function property, as shown below.

    const person = {
      // method
      sayHi: async function() {

      },
      // method shorthand
      async sayHello() {

      },
      // function property
      sayHey: async () => {

      }
    }

Essentially whenever you have a function, put the word `async` in front of it and that will allow you to do awaiting inside of it.

You cannot do what is referred to as top level await.

If you go take the code within the go function and try to run it directly in the script tag and try calling `wait` as shown below, it will not work 👇

    console.log('one');
    await wait(200);
    console.log('two');

We get an error in the console.

> Uncaught SyntaxError: await is only valid in async function

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1164px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:8.533333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgUlEQVQI1x3JSw6DIAAAUe9/tDYurKiABARtEDT+2qTLaeJqkjeFe1QEaRmExlUdo7bUTaB9CiY3EZTDtA75sqh6QDUeWSqM3xA6IHuPkJau97TaUYylIA6RlE/SvJOXizB/6c2bvH5Iy3W/vJzk9botp531+DGlgxB3fNwI83b3D3t6kbcHNFjpAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/27a15bc739567ca6e89d4bcf4760beb0/d74fe/1053.png" title="uncaught syntax error: await is valid only in async function in console" alt="uncaught syntax error: await is valid only in async function in console" class="gatsby-resp-image-image" /> </span>

You can however copy and paste the call to the wait function and call it directly from devtools console.

Let's take a look at some other examples.

Go to our `promises.html` file that we have and let's grab the `makePizza` function, and move it over to the `async await` file.

Both of those functions return a promise.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1500px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:57.599999999999994%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACTUlEQVQoz3XOzWvTcBjA8VinDJ3NL8nSdOnWOdDVoU2a16Zpll9e2rRdquvAbk7wJKbF/0oG04vtpoKwgzLRgy8HRWG6IYI7KczbRLe8SObBHdzDl4fn8oEHefJ+e+3tlwcvNx++2nr0emvt3dfHbz7DhZtYXqNFm+J0jDEooTrMWSRn4owO8hrIa0QBEixEEl4v4d0f6PYHOv2Bbv/k7dUTnd4ZZZ7ijKw2l1WaGdlMi3aKN7GCjRVMwMahByHHuyuJw3VWEl4vqbRJFqY4e7KoT5W1HHQm9NnRskvwFmCtvx6wJoJ4/YTXj02nH9ddPeb1hoptMq9hnAUYI5mHKGOh8aEn8xAw/0KW1z8urW/cefphaX3j7ovNe88/LT/b4NwbgLVodW6sNHsO1s7qjTH96kipRZcu40UXV65gchNILrL7/Vv4+2cU+lHgh6EfhfvBr11n8dbQRT0tN8ZVdwI247T5jNrOGAvUdDtdbuFiA/AOsrfv+34QhFEQhEEQ7e37Ozs/qtc7QxfKWMGiZXOs7I5otYwKU9NVarqaEirJSzoa/28g0aEJwzCKIt/3K4veqZw6zNtZWaeLDq02aNVNS06aNeKtzOCKQ/DWEfiaN5grDfOVrFxLiQ4pNUmpSQgNnHcIsU4IDsZbWOEIXF30Tk+VCd6mxMqIXKelFiXM4byb5OooN4NydcBUAGP+BwcHeHCyRHA2KdZSiouKBiqaqGRTkolLFirbQDIIwTga50o4Z48qznmrNa47o5pNFi2chxgHAQ+BAHHe/AMMiCLrJq40vgAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/ea2bee5f4d50aa3eac5f0965148ec4e1/aa440/1054.png" title="both wait and makePizza functions returning a promise" alt="both wait and makePizza functions returning a promise" class="gatsby-resp-image-image" /> </span>

Go to the bottom of the script tag and make another async function `makeDinner`.

Within that function we will call `makePizza` to make `pizza1` and then we will log it.

    async function makeDinner() {
      const pizza1 = makePizza(['pepperoni']);
      console.log(pizza1);
    }

    makeDinner();

If you comment out the `go` function and the code where we call `go` and instead just run the code we added right above, you will see that we get a promise logged to the console.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1146px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:6.933333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAOklEQVQI113KMQoAMQgEwPz/m4JrIVreicIGLFNMNyczKSJ0d5oZVZURwZlhd6+/mt8DMEJ1P4BVVbwMlkw5fR3BAAAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/1891d4aec91c3491981f04a062c0d0a2/fe9e8/1055.png" title="pending promise in console" alt="pending promise in console" class="gatsby-resp-image-image" /> </span>

That is because we are running the function and storing it in a variable, which will store the promise in the variable. Note that we call it "await" instead of "wait" because it is asynchronously waiting. Meaning it won't actually pause all of JavaScript, it's not going to block the rest of the JavaScript from running.

If we instead put an `await` in front of our `makePizza` function, we will asynchronously be waiting for the pizza to be done, and when it is, we will simply log it.

    async function makeDinner() {
      const pizza1 = await makePizza(['pepperoni']);
      console.log(pizza1);
    }

    makeDinner();

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1182px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:13.866666666666665%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApklEQVQI1yWO647CIBhEff833Kz9kIJAsRXXXhao5pjij5OZZJKTOXXdGWMM3ntSujPeE2Z4oP2EtgGlFL2L/HQa6T0xzbhbQnqHiEJr3ZimqTlOohQhBKy13MaRIXj+BkuMkRA8l4vmrAyir/xKj/GRx3PD+oiINI5DzrmvsJTCvu/knBvbtvEqmf+cqbVSamFZlrat69p4v1/UWlo/tiPneeZwfQCXB+E4AT5TJAAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/225fd4e36f5b48340f9e8484bc19db60/7161f/1056.png" title="pizza with pepperoni log in console" alt="pizza with pepperoni log in console" class="gatsby-resp-image-image" /> </span>

Similarly we can do that with pizza2 as well.

    async function makeDinner() {
      const pizza1 = await makePizza(['pepperoni']);
      console.log(pizza1);
      const pizza2 = await makePizza(['mushrooms']);
      console.log(pizza2);
    }

    makeDinner();

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1124px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:8.8%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZklEQVQI11WMQQrDMAwE8/83hkqyJceKsZNDIfVpQwUp9DAMC8ss4zhQ3X+cusKfXR0pZ6SsKNsGloRshuv6oPcOM4Oq/rGMMeL88K4SMd/3CBIzXkQopUTwu+ecaK2BmUFEYREJ3+yHk+BXaTijAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/9e19650c07a51582b25cb3df643254bc/11b93/1057.png" title="pizza with pepperoni and pizza with mushrooms in console" alt="pizza with pepperoni and pizza with mushrooms in console" class="gatsby-resp-image-image" /> </span>

Now let's say we want to wait for both of those to be done because the way it is coded right now could be possibly inefficient.

This is what is referred to as a **foot gun** in the industry, when you give somebody the tools it is possible they could write code that is not performant.

What that means is if you are making a pepperoni and a mushroom pizza, the way we have coded it, you have to wait for the pepperoni pizza to be created, baked and taken out before we even start making the next pizza.

It is likely that we could be making the pizza's concurrently, so what we can do is instead of waiting for one, then moving onto the next line and making the next one, we will remove the await from both of them, make them both into promises and then make one big promise which we can await.

    async function makeDinner() {
      const pizzaPromise1 = makePizza(['pepperoni']);
      const pizzaPromise2 = makePizza(['mushrooms']);
      const pizzas = Promise.all([pizzaPromise1, pizzaPromise2]);
      console.log(pizzas);
    }

If you do it like above, we will still only get the big promise.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1146px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:14.133333333333335%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhUlEQVQI122NywqEMBRD/f8/FCwD6rXTh1ZXddraM+hCEAwcErJImmEY0JPGe49Mwjj2THZlzwflOMilkFIipfzAWovWGhG5/eya4AJGGYJeGT+CahXeLdQY2UMgxcibcs4X51kp5c7NZjescuj2i2kNq2zMbqbvOrwI5ZeugVrrgzedw3+uMOao+3Iu3gAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/7016024c7eb1a175abf49d804df5aa9c/fe9e8/1058.png" title="promise log with promise status as resolved in console" alt="promise log with promise status as resolved in console" class="gatsby-resp-image-image" /> </span>

We need to modify the code to await the mamma promise like so 👇

    const pizzas = await Promise.all([pizzaPromise1, pizzaPromise2]);

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1132px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:21.333333333333336%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApUlEQVQI143Oyw7CIBBA0f7/91ltfABapUyZoQUKqGkG04WuvfuT3GZd1wltAEgA2VFBTDBka9Kok7ULmKj1oh9p0CTl7SwQkYicc46oYeZ5gKnvw015KbxSXpz8pQtX4aV0pyO2O9y3tG/HQ4cDMXP91tRan+U93WG69mkcC9rFmAyPgttLIZqlmJWKWgelIpifZOYNv8oz2pjmknJGxBBC/SfmD/6F4Y8lFOJaAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/06d46d48c6db728115916ca568d4fe4c/ae953/1059.png" title="resolved promise array with async await in console" alt="resolved promise array with async await in console" class="gatsby-resp-image-image" /> </span>

Now we get the actual pizzas instead of just the promises. Go ahead and destructure the two pizzas that are returned.

    const [pep, mush] = await Promise.all([pizzaPromise1, pizzaPromise2]);
    console.log(pep, mush);

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1132px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:8.533333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/70-async-await/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeElEQVQI1z3NwQrCMBAA0f7/74mKlpom2d00MaDS5GaZYg+e3mVghpwLIoJZwofIK47EGBFRRJXJzZxvjtEJp+vE5T6Tnh9KfR+dqh6a2eFQa8VSYsmZKErPniUlfqNcCrP3PJxDTQkx4IOn98a2fVnXld47rbW/O3oLlDa7PlHEAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/b7ed70a983ad24914107d39995cffd03/ae953/1060.png" title="log of resolved promises in console" alt="log of resolved promises in console" class="gatsby-resp-image-image" /> </span>

What we want to do now is go back to the code that we wrote early on with our promise chain and rewrite it one more time into async await.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1500px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:94.66666666666667%;position:relative;bottom:0;left:0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsTAAALEwEAmpwYAAADNklEQVQ4y12T+46jNhjFeYFyNyEh5J6QZADbGAIEAr4ASeay06nU7W6rrdR5/4eoSKbaUaUj/2Hpp3P8+XzSPs1GW2Kv4CjIp2k3S9t51m6LZld2D/V1W7TL4uLVL24sbFTbiA5gPY7FNO2GEZMAquwDswhVgwpEDYiEgYWJOcDcjISOhQa5BvtLFTIl7KXCD0njqJrmbBCX8v6oh7UVNQaii7LcZN0i5d7pOMs6J+UWblRINcg+Sxo/BDMfg9lOXkUmYiZiOuR23pr1o50380NtV+dB0YC4+x/ZwwNvP0CBsfbkdWRAdhMHiCsBVUMmB1QJaiWgfdrP+nD2ggVK3R1S1+QO64jNstLNOjtp3ePTvH5z8/M8L+f5aZaXbnqycmFnvIdHa38WxKNNqPwHa5AZuDIipiOu49aIOjMSVkStiIKImpjqETMipkEhuV6whOlw5fcw4lYkdMgH+GqhC8BsGJ8sUhuIKgGVfXoLzPvMIdNwIzleMAsTx4PqJjYgs7AwIfey8z4/L45idTxuabuuu3HWOdnVIkILKi2stfCkIS45G38JD/Zyf5s2N0in5m+g+s2mb4D9PWm+W/wfu3kftu9O+65XP9Tyz16nH2rxhzTawmmYgqX/y4qYiBlYaKQbHH8dVV9d/m3R/jUq3vT8apQvMr4q5EmJn2/nixpfJSso3EQ4hKoPpRFSPWRaWIO4AeRsJW8qeVbxWSNPWvKsJq8KedJwp8SvKnnUwkoab/ypT8B0ey/JIBIaZM6h2hbVQ3IGWOiolkMuB7efD+4zu/8zl9xdMHkgw02geYkOKUBcR1RDbJSK2enZLb+Mi5dxKty0MrN2kAuL8J8NczZwHiTDta9u4v7NfUmojtiANKsjWxTNum7CvFnkTE8EOAgQfYInOzjeY32yuU/bRFyD1CTNMG4tXANUm7jSQ6aHVAvqXuHP9ZCmfjLcQGPq3WGbNHfnSVZP8s44PJrJRUZnGV1UdFHxRcPdJ2cfj3fYnPWw8RGbGYjq5NFMX+3id+v4dZh3TtGB6ouVXhV8uW34Dd7T50ki1H0u7wtwX8mbsxOzfVGtCr6jdZiK5ZHqSd/tz7H/BeXeyu2hapKsAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/ef6fe7c5e9de09287299433f6b2d7b3f/aa440/1061.png" title="rewrite the promise chain using async await syntax" alt="rewrite the promise chain using async await syntax" class="gatsby-resp-image-image" /> </span>

Take the entire animate function and copy it and rename it to `animate2`.

Modify the click event to call `animate2` as shown below.

    go.addEventListener('click', animate2);

Go back to the `animate2` function.

The first thing you need to do is mark the function as `async` and then to check that it still works.

    async function animate2(e) {

    }

Open it up in the browser to make sure that it still works. Then refactor the animate function to instead await as shown below.

    async function animate2(e) {
      const el = e.currentTarget;
      // 1. Change the text to GO when clicked.
      el.textContent = 'GO';
      // 2. Make it a circle after 2 seconds
      await wait(200);
      el.classList.add('circle');
      await wait(500);
      el.classList.add('red');
      await wait(250);
      el.classList.remove('circle');
      await wait(500);
      el.classList.remove('red');
      el.classList.add('purple');
      await wait(500);
      el.classList.add('fadeOut');
    }

    function animate(e) {
      const el = e.currentTarget;
      // 1. Change the text to GO when clicked.
      el.textContent = 'GO';
      // 2. Make it a circle after 2 seconds
      wait(200)
        .then(() => {
          el.classList.add('circle');
          return wait(500);
        })
        .then(() => {
          // 3. Make it red after 0.5s
          el.classList.add('red');
          return wait(250);
        })
        .then(() => {
          el.classList.remove('circle');
          return wait(500);
        })
        .then(() => {
          el.classList.remove('red');
          el.classList.add('purple');
          return wait(500);
        })
        .then(() => {
          el.classList.add('fadeOut');
        })
    }

As you can see in `animate2` there are no `.then()` and no callbacks, we simply just pause the function from running with our `await` in front of a function that returns to us a promise.

In the next video we will look at how to handle errors with `async await` and we will go over a lot of the browser APIs that come with `async await`.

Find an issue with this post? Think you could clarify, update or add something?

All my posts are available to edit on Github. Any fix, little or small, is appreciated!

[Edit on Github](https://github.com/wesbos/wesbos/tree/master/src/javascript/12-advanced-flow-control/70-async-await/70-async-await.mdx)

[**← Prev**](https://wesbos.com/javascript/12-advanced-flow-control/69-refactoring-callback-hell-to-promise-land/)

Refactoring Callback Hell to Promise Land

[**Next →**](https://wesbos.com/javascript/12-advanced-flow-control/71-async-await-error-handling/)

Async/Await Error Handling

### <span class="highlight">Syntax Podcast</span>

Hold on — I'm grabbin' the last one.
