






(https://wesbos.com/javascript/04-the-dom/built-in-and-custom-data-attributes)
    1.  [Data Attributes](https://wesbos.com/javascript/04-the-dom/built-in-and-custom-data-attributes/#data-attributes)
-   [Creating HTML<span class="videoNumber">Part 25</span>](https://wesbos.com/javascript/04-the-dom/creating-html)
    1.  [append method](https://wesbos.com/javascript/04-the-dom/creating-html/#append-method)
    2.  [insertAdjacentElement method](https://wesbos.com/javascript/04-the-dom/creating-html/#insertadjacentelement-method)
    3.  [Generating An Unordered List](https://wesbos.com/javascript/04-the-dom/creating-html/#generating-an-unordered-list)
-   [HTML from Strings and XSS<span class="videoNumber">Part 26</span>](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss)
    1.  [document.createRange() and document.createFragment()](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss/#documentcreaterange-and-documentcreatefragment)
    2.  [Security and Santization](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss/#security-and-santization)
    3.  [XSS (Cross Site Scripting)](https://wesbos.com/javascript/04-the-dom/html-from-strings-and-xss/#xss-cross-site-scripting)
-   [Traversing and Removing Nodes<span class="videoNumber">Part 27</span>](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes)
    1.  [The difference between an Node and an Element](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes/#the-difference-between-an-node-and-an-element)
    2.  [Properties to work with Nodes and Elements](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes/#properties-to-work-with-nodes-and-elements)
    3.  [Removing Elements](https://wesbos.com/javascript/04-the-dom/traversing-and-removing-nodes/#removing-elements)
-   [Cardio<span class="videoNumber">Part 28</span>](https://wesbos.com/javascript/04-the-dom/cardio)
    1.  [closest method](https://wesbos.com/javascript/04-the-dom/cardio/#closest-method)




##### <span class="grit">Module 12 - Advanced Flow Control</span>

-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/66-the-event-loop-and-callback-hell" class="currentModule">The Event Loop and Callback Hell<span class="videoNumber">Part 66</span></a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises" class="currentModule currentPage currentSection">Promises<span class="videoNumber">Part 67</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises/#then-method" class="currentModule currentPage">.then() method</a>
    2.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises/#promiseall" class="currentModule currentPage">Promise.all()</a>
    3.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/67-promises/#promiserace" class="currentModule currentPage">Promise.race()</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/68-promises-error-handling" class="currentModule">Promises - Error Handling<span class="videoNumber">Part 68</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/68-promises-error-handling/#promiseallsettled" class="currentModule">Promise.allSettled()</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/69-refactoring-callback-hell-to-promise-land" class="currentModule">Refactoring Callback Hell to Promise Land<span class="videoNumber">Part 69</span></a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/70-async-await" class="currentModule">Async/Await<span class="videoNumber">Part 70</span></a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/71-async-await-error-handling" class="currentModule">Async/Await Error Handling<span class="videoNumber">Part 71</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/71-async-await-error-handling/#handling-errors-with-higher-order-functions" class="currentModule">Handling Errors with Higher Order Functions</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui" class="currentModule">Async/Await Prompt UI<span class="videoNumber">Part 72</span></a>
    1.  <a href="https://wesbos.com/javascript/12-advanced-flow-control/72-async-await-prompt-ui/#running-an-event-listener-only-once" class="currentModule">Running an Event Listener Only Once</a>
-   <a href="https://wesbos.com/javascript/12-advanced-flow-control/73-async-typer-ui-two-ways" class="currentModule">Async Typer UI - Two Ways<span class="videoNumber">Part 73</span></a>

##### <span class="grit">Module 13 - Ajax and Fetching Data</span>

-   [AJAX and APIs<span class="videoNumber">Part 74</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis)
    1.  [What is an API?](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#what-is-an-api)
    2.  [JSON](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#json)
    3.  [AJAX](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#ajax)
    4.  [Public API list](https://wesbos.com/javascript/13-ajax-and-fetching-data/74-ajax-and-apis/#public-api-list)
-   [CORS and Recipes<span class="videoNumber">Part 75</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes)
    1.  [Query Parameters](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#query-parameters)
    2.  [CORS](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#cors)
        -   [What is CORS?](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#what-is-cors)
        -   [CORS policy](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#cors-policy)
    3.  [Babel](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#babel)
    4.  [Browserlist](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#browserlist)
    5.  [Proxy](https://wesbos.com/javascript/13-ajax-and-fetching-data/75-cors-and-recipes/#proxy)
-   [Dad Jokes<span class="videoNumber">Part 76</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes)
    1.  [Headers](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes/#headers)
    2.  [Getting a Random Index](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes/#getting-a-random-index)
    3.  [Loading State & CSS Loader](https://wesbos.com/javascript/13-ajax-and-fetching-data/76-dad-jokes/#loading-state--css-loader)
-   [Currency Converter<span class="videoNumber">Part 77</span>](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter)
    1.  [Caching the Rates](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#caching-the-rates)
    2.  [Converting](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#converting)
    3.  [Hooking Up The UI](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#hooking-up-the-ui)
        -   [Input Event on a Form](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#input-event-on-a-form)
        -   [Wiring up Handlers](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#wiring-up-handlers)
        -   [Formatting Currency using Number Format API](https://wesbos.com/javascript/13-ajax-and-fetching-data/77-currency-converter/#formatting-currency-using-number-format-api)

##### <span class="grit">Module 14 - ES Modules and Structuring Larger Apps</span>
##### <span class="grit">Module 15 - Final Round of Exercises</span>


<span class="grit">Promises</span>
==================================


JavaScript, PromisesEdit Post

The solution to callback hell is to use a **promise**, and although we haven't covered that yet, we will now.

Promises are an IOU (I Owe You) for something that will happen in the future.

If you think of our timer, data being returned from an API or someone giving access to a webcam, when we request or start those things, what we often get in return is not the immediate data back, because those things take time. Instead of getting the immediate data returned, we get a promise.

You can think of a Promise as a little ticket you have in your hand that says "I might get a timer, or some data at some point" and eventually at some point we will get some data back (it can also fail which is called rejecting).

Or, when we were asking for a user's webcam, like we did in our Face Detection exercises, we used the code below.

    const stream = await navigator.mediaDevices.getUserMedia({
      video: { width: 1280, height: 720 },
    });

    video.srcObject = stream;
    await video.play();

We had to wait for the user to give us access to their webcam before playing the video. That happens all the time in JavaScript, and that is what a promise is.

In the `playground` directory, make a `promises.html` file. Add our base HTML and the following script tag.

    <script>
    function makePizza() {

    }
    </script>

Inside of this script tag, we are going to make a pizza promise.

When you make a pizza, it takes time. You can't make it instantly. You gotta put the toppings on, the pepperoni on, and that takes time.

If you were to order a pizza by phoning them or doing it online, they will immediately give you some sort of order number. That order number is not the pizza -- you cannot eat it, but you know that the order number or that receipt is a "promise" that they will give it to you when its finished.

So what we need to do is to make a promise and then return it from our function immediately as shown below.

    function makePizza() {
      const pizzaPromise  = new Promise();
      return pizzaPromise;
    }

Promises are made immediately, but they do not resolve immediately (they resolve once the timer is finished or the data comes back).

That idea of returning happening immediately and resolving happening when it's done is really important.

A promise takes a callback function, and that callback function is going to give us 2 arguments:

1.  the `resolve` function
2.  the `reject` function

The first will always be resolve, second will always be reject.

Now what you can do is when you are ready, you can resolve the promise or if something went wrong you can reject it, as shown below.

    function makePizza() {
      const pizzaPromise = new Promise(function(resolve, reject) {
        resolve('');
      });

      return pizzaPromise;
    }

    const pizza = makePizza();
    console.log(pizza);

Now if we refresh the page, what do you think we will get in the console? Will we get the pizza or something else, like a promise?

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1130px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:5.866666666666666%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAARUlEQVQI1zXFQQqAMAwAQf//xhakJCEYacGTCYX15FzmWGvRWkNViSswM9SMZ95MOXmzqCrqv4rMZO9NRNB7R0QYY+DufOvTS4GpDEF4AAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/64bb1cea31dae643331cb8283afed2f8/d56e1/1020.png" title="resolved promise in console" alt="resolved promise in console" class="gatsby-resp-image-image" /> </span>

If you refresh the page, you should see the promise.

What is important to note is that our `makePizza` function doesn't give us the pizza, it gives us the promise of pizza, that at some point in the future, we will either resolve a slice of pizza or reject it if something went wrong.

Let's make the function a bit more robust.

We will take in some toppings and will resolve using backticks. Modify the code as shown below to make a `pepperoniPromise` and a `canadianPromise`.

    function makePizza(toppings) {
      const pizzaPromise = new Promise(function(resolve, reject) {
        resolve(`Here is your pizza 🍕 with the toppings ${toppings.join(' ')}`);
      });

      return pizzaPromise;
    }

    const pepperoniPromise = makePizza('[pepperoni]');
    const canadianPromise = makePizza(['pepperoni', 'mushroom', 'onions'])

    console.log(pepperoniPromise, canadianPromise);

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1142px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:26.400000000000002%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4ElEQVQY002Oy27EIAxF8/9f10WlqlNNOspjEsA2OGAMTKJUUbvoWd3N0T2dap6+e7CWrIXVoDFN4q75pdpEmsg1UnqJ5FwdoLMWEQFcra2rqjCMflp5Nc9HP90+S/SVuUlSIgVXQsgAjTlKbcf5n+48z83E8W2a35/Tx3MdnJ/G0N95HFqWlmJLfP1Laimq93XbClEJYd/37jgOtzpYABeEBQJx4fD601KNW0vhyk6xbtuvrESV+dj3TmKcv260zH6ZcR5heJQAxVNhzs6JMUqU1kUIM6JYp54UMTMf5/kDLi4aUzsoSfYAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/a4247965d34e3fec131b6e1bb30c817e/b490f/1021.png" title="two resolved promises in console wrapping the data in console" alt="two resolved promises in console wrapping the data in console" class="gatsby-resp-image-image" /> </span>

As you can see, we get our 2 promises. But how do we get the actual pizza itself?

This is a bit confusing because the dev tools will show you the value when it is resolved, but in JavaScript if you actually want to access the value of the pizza, you cannot say `pepperoniPromise.value` or anything.

<span class="grit"><a href="#then-method" class="hash-anchor before"></a>.then() method</span>
----------------------------------------------------------------------------------------------

The way that we can access it by using the `then()` method, which takes in a callback method. The callback method will pass you the pizza, which we will then log.

    pepperoniPromise.then(function(pizza) {
      console.log("Ahh I got it!");
      console.log(pizza);
    });

Now when you refresh the page you should see the logs below.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1156px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:8.533333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcElEQVQI102MwQoDIQwF9/+/0aJRttrEdksPNRH0FXLqaWAY5qi1gpmhqphzwsYX0xRq5s7+aKYYYzjXWt4TEW4hoJSCGCOO63r7UETQuONVCz7PBxoLpHcwC1Ii1NZwnndQLt7uvX2Yc0YIwUmJ8ANSL5dCQG9PrQAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/93798940dd9ed80f544b8f05c70e7716/9937c/1022.png" title="resolved promises with the actual data logged in console" alt="resolved promises with the actual data logged in console" class="gatsby-resp-image-image" /> </span>

At this stage, you might be wondering "why are you doing it like this Wes? this seems like a much harder way to just return data".

The reason for that is we haven't introduced any time delays in our example so let's go ahead and do that.

We will add a 1 second wait for the pizza to cook using `setTimeout` and then call `resolve` from within that timeout.

    function makePizza(toppings) {
      const pizzaPromise = new Promise(function(resolve, reject) {

        // wait 1 second for the pizza to cook
        setTimeout(function() {
          resolve(`Here is your pizza 🍕 with the toppings ${toppings.join(' ')}`);
        }, 1000)

        // if something went wrong, we can reject this promise
      });

      return pizzaPromise;
    }

    const pepperoniPromise = makePizza(['pepperoni']);

    pepperoniPromise.then(function(pizza) {
      console.log("Ahh I got it!");
      console.log(pizza);
    });

If you refresh the page, you will see in the console that we get our promise immediately and then a second after we actually have access to our pizza.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1158px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:13.600000000000001%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAn0lEQVQI1z3O6wqDMAyGYe//DgVBbGu32tqtdTp72N5hfyzwQELIRzqtNRdjDEpKhJCEEMk5k1Iip8S2nzzim+d2Nj6+ifuJ9x4hBPM8N0opur7v2xBC4DgOXlsknwel1BZaSmk+tVLr1We+n8pVzjmu+3Ec/zohZVtYa1n9g9Xc2L1hsQ63riyLbV/fzYJUillrYtz+gcMwME1TI6XkB+UX4m/uqdrZAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/d0a1df772e6dc1c4219b4fdc8a0c81ef/1132d/1023.png" title="on refreshing the page, promise and its data is resolved" alt="on refreshing the page, promise and its data is resolved" class="gatsby-resp-image-image" /> </span>

That is a great example of how we sometimes have to wait.

Often what you will see is instead of making a promise and then returning it, people will often just return the promise immediately.

    function makePizza(toppings) {
      return new Promise(function(resolve, reject) {
        // wait 1 second for the pizza to cook
        setTimeout(function() {
          resolve(`Here is your pizza 🍕 with the toppings ${toppings.join(' ')}`);
        }, 1000)

        // if something went wrong, we can reject this promise
      });
    }

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1500px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:34.13333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMklEQVQY023P3U6DMBTAcZ6Anq5SM/ZhNo3AaAsbY9DCoLAV47yZiS7x/V/EdPPCGJNfTv45V+c4z7vTIjPLQj6V5aM6LuvzfHf0Uk2SnoiOJAcsemD6X86i7KfFaVIMs+plVp3n5ZdfXGh1GVefVH746p1kr5AYnBhIBysxVzYcspK+qHyhJsL47O0+NmTVuWHjhnsIWwgqHFTYtoKggKCEQEJQ4lDisHRIrCbrep5rsutGG423B5RpnLXTTePmGmUabVs3134+TPNhvNZ+WlAhPbHHUeWMVvUDb5dpA6IGpoBL4Apz5cXXYAqEDSoamnSU7ykr75girMaRcjzR4bgHbhAfEDtCfEB8gLhHcY+YAbvpEDMuO0KkIJT2/lDhyHIor3FkH/gRSRzd5m+3jfrjGzTpRqTfKsYYAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/6fed87d8af741406cb1c645e4500b25f/aa440/1024.png" title="creating a new promise and resolving it after a second" alt="creating a new promise and resolving it after a second" class="gatsby-resp-image-image" /> </span>

The logic to how a Promise gets resolved is always inside of the Promise body, which in the example is the code below

    function(resolve, reject) {
        // wait 1 second for the pizza to cook
        setTimeout(function() {
          resolve(`Here is your pizza 🍕 with the toppings ${toppings.join(' ')}`);
        }, 1000)

        // if something went wrong, we can reject this promise
      }

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1500px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:37.333333333333336%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUElEQVQY023Q3UvCUAAF8BFzX9Z2r1vSUxAZ7W5m2b3T7W67Lix7jYLog6B6KMgUP9CsHoIehHroIZGKIOjJ/swwiECDH+ftwOFw05Y345QMUgJWqKFAMwNgusAkcPFPwsxBRMdxybSfXPJTTml+JUjh7ALJzHk7s/TUIHuQHAK8D50jNbMFkT/mpyzjipK70f1r3e8Y4S1gfaUwEMOezJ5E9qy6NS29mTAxRHmI3F/esKwjyrsPXPAhshcpehOjL4EN+PCTd+5E3IiRK2G1JuGq6LQnM7vAWtPsDc1eB3YRIp8zLBrL33Peuxb1E8VeLGwItCYEDYnVAW3GwpYQtvlCU2Edg7V0WtbzJ2ruTHXOgVXgkulgwn0Uwtcp2o3TruTUZVyRSEXCZQmXZXwpD/NCJlUlezw620BefPkgSbYTVl5DFNoRsAr/iYDFRg77Bg2AUsb6JygrAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/5520e752e8547d435ab2fcc7de4c820f/aa440/1025.png" title="the logic of resolving a promise" alt="the logic of resolving a promise" class="gatsby-resp-image-image" /> </span>

That function will resolve or reject whenever it feels ready. In our case, we feel like the pizza is ready after one second.

So what is happening here is when we declare our `pepperoniPromise` we can call `makePizza(['pepperoni'])`, which returns a promise of pizza. In order to get the pizza, the way we can access the resolved value is by chaining a `.then` onto it.

    console.log('Starting');

    pepperoniPromise.then(function(pizza) {
      console.log('Ahhh got it!');
      console.log(pizza);
    });

    console.log('finishing');

When you refresh the page you will see that we get "Starting" then "finishing" then the "I got it" message.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1134px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:16.799999999999997%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAh0lEQVQI143MWw6CMBRFUeY/QBIKhRJb+7oWkT8IbGMdgJ5k/52spiwL4zRxs5Z93zmO46/O88RZR9u2DMOAUoqUEs1zXdHjyGRMBa/rqudffRZCoFc98zyjtf6CpRScu5NzRkSIKfOSwJIj8ihkEay7E2PCh4C1jm3bKui9p+s6jDEVjDHyBtyx47wfg9dDAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/dd127eca228ae3beb335efa27ea58d3d/75a80/1026.png" title="starting, finishing and data of promise in console as logs" alt="starting, finishing and data of promise in console as logs" class="gatsby-resp-image-image" /> </span>

We will look at how we can use `async/await` to actually do that sequentially if we would like to, but for now we know we can chain a `.then()` onto it.

Why is that any more useful than a regular callback?

That is useful because let's say we wanted to make multiple pizzas one after the other, and we have an oven that can only cook one at at time.

Delete our `canadianPizza` and `pepperoniPizza` declaration code and everything below it in the script tag and just leave the line below

    makePizza(['pepperoni']);

We can chain a `.then()` immediately onto it (because `makePizza` returns a promise), which gives a function that has a pizza. LLog the pizza so that we know that it still works.

The neat thing is if from this `then()` we return another `makePizza`, you can then chain another `.then()` on that function.

    makePizza(['pepperoni', 'ham'])
      .then(function(pizza) {
        console.log(pizza);
        return makePizza(['ham', 'cheese']);
      }).then(function(pizza) {
        console.log(pizza);
      })

As you can see first we get one pizza and then after a second we see the other pizza logged to the console.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1170px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:20.533333333333335%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAv0lEQVQI1x3BwXKDIBAAUP//23rptFMVCKwoLCwuiybaSXKwM32vAwCtdUpJKa2UWkL++Ox/Ruf93Pd9xKiUMjeDiDlnZl7/EREAdM45Y4z3PsYoIqWUTGvKRSt9g+XbzF8jxPUe+T7aoLUx2lhrW2vDMHTHcUyTJ6IQQsREi2OcQ0TE6AAseOsmB56lvd5v7702BgCccyLSHb/PhGnfd5FWq+yVH5twlbZtRFRKqbUyc2vtui5mRkQiSimd5/kHq//X36y5W/YAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/900a280a6fd4dbd32fa2be7110fdf329/105d8/1027.png" title="first we get one pizza and then after a second we see the other pizza logged to the console" alt="first we get one pizza and then after a second we see the other pizza logged to the console" class="gatsby-resp-image-image" /> </span>

You can chain as many as you want.

Often people like to organize the code so that each `.then()` is on it's own line to make it more readable as you see below.

    makePizza(['pepperoni', 'ham'])
      .then(function(pizza) {
        console.log(pizza);
        return makePizza(['ham', 'cheese']);
      })
      .then(function(pizza) {
        console.log(pizza);
        return makePizza(['hot peppers', 'onion', 'feta']);
      })
      .then(function(pizza) {
        console.log(pizza);
      })

Unlike what we were doing the lesson where we were adding and removing classes which were all nested in callback hell, this chaining of `then` is the promise land and it allows us to keep all of our logic one level deep.

The downside to that is if you had a log of First and After all our promise chaining, both logs would execute before any of our pizzas are logged.

    console.log('First');

    makePizza(['pepperoni', 'ham'])
      .then(function(pizza) {
        console.log(pizza);
        return makePizza(['ham', 'cheese']);
      })
      .then(function(pizza) {
        console.log(pizza);
        return makePizza(['hot peppers', 'onion', 'feta']);
      })
      .then(function(pizza) {
        console.log(pizza);
      })

    console.log('Right after');

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:752px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:33.33333333333333%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABPUlEQVQoz42RW4ucQBCF/f9/J2RJCGHzvHkIkxB1dnS079pqj6thZwZGv2CTLPuSJQcOXUUf6tQlUUqx8Xa7sWFZlhj/5fIqfovn85k0TUkORUEtBCEElNbM88xrrPwftkb2+0eSx0OBMZZhGLDO0XrPNE30Q+ApdDx7SRgnTqdTNB3HkSGEqPNdxzTNuKbBGMPDw1eSLN+/FJRKIYSMeVkLrCj5JVKkbZBSxUmU0pTHIz/TjDTLo3b3/QdZnvPh4ycSqTRDGHgaR7qup2nb6Kyto280s97T+J629fGv63usdRyriroWMdfa4L3n8/0Xkm+7HUVZxv1tLlsXbdtSC0lrJM/uiHYN1lm0MXG8bYptX4dDEbVaa6qq4t37O5JNZKxjCCeEVFwul5djrP84yrqukcufd8P1eiXLcn4D1/IOY6y3Ru4AAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/5ea2c832d98609d387dd0a58caac0729/442cb/1028.png" title="promise chaining example in console" alt="promise chaining example in console" class="gatsby-resp-image-image" /> </span>

We will look at how we can use async/await to get around that.

If you look at the call stack, what we know is that it first runs the function `makePizza(['pepperoni'])` (highlighted in the image below), which immediately returns a promise.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1248px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:62.133333333333326%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpUlEQVQoz4WRy27TQBSG8wIIz4yvCU4cQxp7fIkvHXtmjmfsOjhtlFbdtEg8AquuWLJggXhthAQIqZRIZ/FvPv2fzj/D+UCuPqDx44Lfr/gJD49m/0CaB6s4YspRLP9zM5JPi6un1funYPhs99/QzVfj8OXV9H0zfnJT/joCRF+GUSwt2vicreQYVtO7vA/ZcaPv5tlobpURSeNCGFtpROIfMKZgxOAxtZC9z0TEm223D+HgsJ7sgKRgMWWV4OwUiuFZMwUn7fysnVPmZY1fskVeu3lr1p1ZdCQDu1FW9RIcg5dBULNlMSzT4zyZ3HT/ht3Ms9GKlBGLM9qYSld08/6wZPuLSr+Fu1Dfu8VIIjjzbUwBxbAq26BugktGRRWJNuTK4dpulad6V2ic/pR3QeMEbK5d3nmlRjHMEJVuptc1j/jlprzelLfr/HrdHsPu1s/3OPk9FZV/AqaSJPCr2YwlYQNSk1OrdSkCcVq2J5JoYyvPaCMKXjVYpTapcFJOyo7kkuzA3AFJzsE47XAzGO24KERQMFdomym7UTYDJ5fP5/kb/gF6oHqX/PtYJwAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/7a3a1ffc1f01df4bdd4fef48c4391314/5a791/1029.png" title="promise chaining in javascript code" alt="promise chaining in javascript code" class="gatsby-resp-image-image" /> </span>

Then it runs the bottom log, before jumping back up to the first `then()` we have when the promise is resolved, and then it keeps going down the promise chain.

Let's make our `makePizza` function a bit more resilient, starting with `toppings`.

Set an empty array as the default because sometimes people might order a pizza with nothing on it.

    function makePizza(toppings = [])

For every single topping that is added to the pizza, let's add 200 milliseconds to the initial bake time which is 500. Let's calculate that and save it in a variable as shown below 👇

    const amountOfTimeToBake = 500 + (toppings.length * 200);

Now we will take that variable and pass it to our timeout.

    function makePizza(toppings = []) {
      const pizzaPromise = new Promise(function(resolve, reject) {
        const amountOfTimeToBake = 500 + (toppings.length * 200);

        // wait 1 second for the pizza to cook
        setTimeout(function() {
          resolve(`Here is your pizza 🍕 with the toppings ${toppings.join(' ')}`);
        }, amountOfTimeToBake)

        // if something went wrong, we can reject this promise
      });

      return pizzaPromise;
    }

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1322px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:58.666666666666664%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkklEQVQoz42SaW7bMBBGc4No30w7jrcaMUrtJiWRioakJMcqrDZI73+VwkY2oEFd4MNg/jzMm8HcGKFwee/KY1DKDS39RvnQBUToIVzNjRGJJeO7hu042xT9VA5T2SM4zElvhOI6rIfijvJV3a7oyzof5/txAb/ndLSx0kPQvoOGQcPN17CGwaFyqg4Blw+sfFDDGk4+66xcmKmwqXKJcFKl/yVyhs1IohQmceUnFSIsyKog4zYBay+tVHm88wrhZO3XsB3LZcHviVikP2fJ6MdHxE4o/2FhaUTCwOL2H9p6eNaeqAHxYUNg0zwvxYtPnsy3UUb0iYku+XwwlD9+Y+y+eNzVfMubFe9Q3XmsQ7L36tZKpcuUV7dmIr26nVTKyzsNX2ArkjMit8C31bCl45qOK/5rAc8oO9qJMmIwQjjX+NXiEvE62cJg50qvn4yin6X1rDqhcjTj9hY3On6zxfDRv++sh8IhnV8erKiZxNyi0tyDmYNDlZ38x5MYpNXLg7OXdxlzS+mUyqbKKZSTXoH/ADQGhDX4P82SAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/179c2e7d48389d5a4a56d0fa926dc56e/203d3/1030.png" title="sequence of resolved promise is ham and cheese logged to the console faster than the pizza with 3 toppings" alt="sequence of resolved promise is ham and cheese logged to the console faster than the pizza with 3 toppings" class="gatsby-resp-image-image" /> </span>

When we refresh the page and the above code is executed, what should happen is ham and cheese should be logged to the console faster than the pizza with 3 toppings.

Let's chain 2 more pizzas together, one with no toppings, the other with a lot of toppings. Then let's resolve that last pizza and just log it using an arrow function as shown below.

    console.log('First');

    makePizza(['pepperoni', 'ham'])
      .then(function(pizza) {
        console.log(pizza);
        return makePizza(['ham', 'cheese']);
      })
      .then(function(pizza) {
        console.log(pizza);
        return makePizza(['hot peppers', 'onion', 'feta']);
      })
      .then(function(pizza) {
        console.log(pizza);
        return makePizza();
      })
      .then(function(pizza) {
        console.log(pizza);
        return makePizza(['one', 'two', 'three', 'four', 'one', 'two', 'three', 'four', 'one', 'two', 'three', 'four']);
      })
      .then(pizza => {
        console.log('All done! here is your last pizza');
        console.log(pizza);
      })

    console.log('Right after');

<span class="grit"><a href="#promiseall" class="hash-anchor before"></a>Promise.all()</span>
--------------------------------------------------------------------------------------------

Let's say we have a big oven and we can make all the pizzas at once. You could run them all **concurrently**, instead of one after another like we are doing (which is referred to as **sequentially**).

If you have 10 employees and an oven big enough to cook them all at once, you can do it like so 👇

    // Run them concurrently
    const pizzaPromise1 = makePizza(['hot peppers', 'onion', 'feta']);
    const pizzaPromise2 = makePizza(['one', 'two', 'three', 'four', 'one', 'two', 'three', 'four', 'one', 'two', 'three', 'four']);
    const pizzaPromise3 = makePizza(['ham', 'cheese']);

So how do we know when all of those promises are done? We could do `.then()` on each of them like so 👇

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:890px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:58.666666666666664%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAACPklEQVQoz0VS246aUBT1B0Y4oFbE8YJ4mcZzDkUYb3BugCIqCmWcaacvTfrQ6aT//9pAJmmyHvbeydpZa69dUyDRFmHTDgDmfS8d+heDXA2SGTTr+Vl7GZubjbnxDD8Z0ry7Pmqur9s7FQcy5jUFEt2JVEsAzO8354HIBmE+CPKhyCbk1N8mYxLMqDBZ2vev3XXSXhCtIgPMaypi7UUoQ6pYAkCq+Hs1OKrhUdnGM/dxSnaj8HUcPHf9HGBeh0RGQsYMYF6RMes4JRngwHR3Dcuvf6bSnEhzWodMgqwO+d2c1+dUgiVkxP+TASQdJ2raoYy4STOT5SYrTFaMeTFkhb5KJtvV1FuP2ckUt972rLted7Fv4FDGrKZAqruRUm3qrJJ7ce1FWQl+nfl7wz+M2eFB7E2edbdnbXlo2fTTl0jB4kO27kYSJIrFVcRUb6fQWGUHdb0fO8uRFw35y4h91b0LwPxDNmKgVM5qKqJtO5ARB1Y0Wh6aNq/PhYS4hMQdKvOol0U1wULGQrYC2QpAhVoD89E2aW4yyf9mpr8n6ds0/TNN3ybXdyN9XxY3mMQP8Wma/pxmfwfJr67Ie+yH6r9K/nMl24mAvQPusbW+dKInPXnpHF708DZjR7hPJ7un2a4YRt81L2+tL43HuOmeFOcEnGOZs+aE8pwomLcwb2zDMmoSq6vIcFaDddSnxYBcO5tz5ZkAxGREAWIAVZ61RVA2ODSXcctm8pwDyEBpMiitQlLdiZVfVD0iKE9d4h8llI1HXJyFDAAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/e1284eb75fe26cd5181fdd68169f3291/4ef49/1031.png" title="multiple promises executing simultaneously in code" alt="multiple promises executing simultaneously in code" class="gatsby-resp-image-image" /> </span>

But those are going to pop into the console in whatever order they are done, which isn't what we want. We can instead make it into a "mega promise" that we then wait upon.

If you have a few promises and all you care about is when all 3 of them are finished, you can make a mega promises, which we will call a `dinnerPromise`.

    const dinnerPromise = Promise.all([pizzaPromise1, pizzaPromise2, pizzaPromise3]);

`Promise.all()` is a static method because it lives on the "momma" Promise directly.

It takes an array of "baby" promises which are `pizza1`, `pizza2`, `pizza3`.

That makes one big promise which then you can call `.then()` on and we get passed the `pizzas` which we will log.

    dinnerPromise.then(pizzas => {
      console.log(pizzas);
    })

Now we wait for all 3 to be finished, and we get an array of all 3 of them.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1134px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:25.866666666666667%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA70lEQVQY002IyW6DMBQA+f//ai+RmgoKlFYlLF5i82zjBZvEGCrUS0dzGE22em/17Bh76DlIsUoRBATBgpIeIAhwlAQBq1IGjUNdtkXRV1Wb58HabNGalRXUlfxuRF1D/q6+CiiusmmgyMnrC7++iaqEj4JcLlOHwwQPmALnC2PZvh9GatXf/MQtwZYQR7Dtm7MxNuMgm8/zYDS3PzPCllLH7o7z4ziyPe1udqq7OcYXjAO7O4w86RwljhJLsKhKi0aDRjP09k5j8NEvcVm2GLOUkhVWU2lmZ5SSAM91PVLat+3PFJ8pbinG0207/vEL0noVMLH3+jgAAAAASUVORK5CYII=');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/6a398f1411dc66be76053c6b5311ab3c/75a80/1032.png" title="multiple promises logging in an array in console" alt="multiple promises logging in an array in console" class="gatsby-resp-image-image" /> </span>

If you wanted the first pizza it would be `pizza[0]`.

A pretty common thing to do is destructure the pizzas.

Let's convert the arrow function to a regular function to make it clearer to understand.

We will use **array destructuring**. Let's call the first pizza `hottie`, second one `garbagePail` and third one `hamAndCheese`.

Those will now be equal to 3 variables which we can now log or use however we want like so 👇

    dinnerPromise.then(function (pizzas) {
      [hottie, garbagePail, hamAndCheese] = pizzas;

      console.log(hottie, garbagePail, hamAndCheese);
    });

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1118px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:13.333333333333334%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlklEQVQI1yXISQ7CMAwAwP7/e11I4jpbE6citJUQix1BxYE5TnetNWUqpeRMe7JrISplLXmJcTQePBmXeoWXOR73123bYUbvQwjROteFuChtlDFxSd4iWqtnRD0GUIAIMzjvhnEAMCnnYAFVP2ltwNRaOx9iJspEwzhtxyGtMfOLWaSJCDP/5838eD6Z+dOERaS173n+APTvohV3CD8XAAAAAElFTkSuQmCC');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/02cd3c00973263711953a330cadff518/0f246/1033.png" title="array destructuring and printing the resolved promise in console" alt="array destructuring and printing the resolved promise in console" class="gatsby-resp-image-image" /> </span>

You do not have to destructure those variables in the body of the function, you can destructure the argument directly with square brackets.

    dinnerPromise.then(function ([hottie, garbagePail, hamAndCheese]) {
      console.log(hottie, garbagePail, hamAndCheese);
    });

That is saying take the first argument and destructure it into a variable named `hottie` , the second one into `garbagePail` and so on.

If you refresh the page you will see it still works.

To reiterate, `Promise.all()` will take all of your promises and will only resolve when all 3 of the sub-promises have been resolved themselves.

<span class="grit"><a href="#promiserace" class="hash-anchor before"></a>Promise.race()</span>
----------------------------------------------------------------------------------------------

Similarly there is `Promise.race()`. Let's say someone is really hungry and they will take whichever pizza the first pizza is that is ready because they are very hungry.

We could do this 👇

    const firstPizzaPromise = Promise.race([pizzaPromise1, pizzaPromise2, pizzaPromise3]);

Now we can log it.

    firstPizzaPromise.then(pizza => {
      console.log('You must be hungry, here is the first one ready');
      console.log(pizza);
    })

TO reiterate, `Promise.race()` will wait for the first one to finish rendering.

<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:1132px"> <span class="gatsby-resp-image-background-image" style="padding-bottom:10.4%;position:relative;bottom:0;left:0;background-image:url(https://wesbos.com/javascript/12-advanced-flow-control/67-promises/'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAf0lEQVQI1yXFSQ6CQBBAUe5/KuOwFxUMU0MX1ZMzxpXGfBNcvLxsVyuLrWVTeFYHZZkL6yKQ146qE2qjHE2gNIl942Y2vZA0UXdCWfVU7X8jkUz8CeMudHqmkUQ1BFQDopHRRdQnzCA4H9EQ6e3I7fHk/fliRWlaM992A9f7xA9ur5Ei+eBx/gAAAABJRU5ErkJggg==');background-size:cover;display:block"></span> <img src="https://wesbos.com/static/cb63aeb746b0729b09301c5d518fd002/ae953/1035.png" title="promise.race() output in console" alt="promise.race() output in console" class="gatsby-resp-image-image" /> </span>

There are also a couple of other ones which we will get into when we talk about error handling.

That is a high level overview of promises.

Find an issue with this post? Think you could clarify, update or add something?

All my posts are available to edit on Github. Any fix, little or small, is appreciated!

[Edit on Github](https://github.com/wesbos/wesbos/tree/master/src/javascript/12-advanced-flow-control/67-promises/67-promises.mdx)

[**← Prev**](https://wesbos.com/javascript/12-advanced-flow-control/66-the-event-loop-and-callback-hell/)

The Event Loop and Callback Hell

[**Next →**](https://wesbos.com/javascript/12-advanced-flow-control/68-promises-error-handling/)

Promises - Error Handling

### <span class="highlight">Syntax Podcast</span>

Hold on — I'm grabbin' the last one.
